<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>John Chandler Burnham - Notes (HPFP 13/31): Building Projects</title>
        <link rel="stylesheet" type="text/css" href="../../css/default.css" />
    </head>
    <body>
        <div id="header">
            <div id="navigation">
                <a href="../../">jcb</a>
                <a href="../../posts.html">posts</a>
                <a href="../../projects.html">projects</a>
                <a href="https://github.com/johnchandlerburnham">github</a>
                <a href="https://twitter.com/John_C_Burnham">twitter</a>
            </div>
        </div>
        <div id="content">
          <div id="title">
            <h1>Notes (HPFP 13/31): Building Projects</h1>
          </div>
          <div class="info">
    Posted on November  1, 2017
    
        by jcb
    
</div>
<div class="info">
    
    Tags: <a href="../../tags/notes.html">notes</a>, <a href="../../tags/haskell.html">haskell</a>, <a href="../../tags/hpfp.html">hpfp</a>
    
</div>

<hr>

<h1 id="building-projects">13 Building Projects</h1>
<h2 id="more-on-importing-modules">13.6 More on importing modules</h2>
<h2 id="imtermission-check-your-understanding">Imtermission: Check your understanding</h2>
<ol style="list-style-type: decimal">
<li><code>forever</code>, <code>when</code></li>
<li><code>Data.Bits</code>, <code>Database.Blacktip.Types</code></li>
<li>Types for <code>blacktip</code>’s database</li>
<li></li>
</ol>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li><code>MV</code> is <code>Control.Concurrent.MVar</code>, <code>FPC</code> is <code>Filesystem.Path.CurrentOS</code>, <code>CC</code> is <code>Control.Concurrent</code></li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li><code>Filesystem</code></li>
</ol></li>
<li><ol start="3" style="list-style-type: lower-alpha">
<li><code>Control.Monad</code></li>
</ol></li>
</ul>
<h2 id="chapter-exercises">Chapter Exercises</h2>
<h3 id="hangman-game-logic">Hangman game logic</h3>
<p>See my <a href="https://github.com/johnchandlerburnham/haskellbook/tree/master/13/hangman">hangman project on GitHub</a></p>
<p>I debated whether or not to include code snippets of full-fledged stack projects in this document. I’ve decided against it. It’s one thing to include self-contained modules as question answers, but if I were to, for example, include the <code>Main.hs</code> file for the hangman project here, there’d be some implicit dependencies like dict.txt and hangman.cabal, and if the past 524 pages of this book have taught me anything, implicit dependencies are bad news.</p>
<h3 id="modifying-code">Modifying code</h3>
<ol style="list-style-type: decimal">
<li><div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">--13/CipherIO.hs</span>
<span class="kw">module</span> <span class="dt">CipherIO</span> <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Data.Char</span>
<span class="kw">import </span><span class="dt">System.Exit</span> (exitSuccess)

<span class="ot">caesar ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span>
caesar key string <span class="fu">=</span> go key <span class="fu">$</span> (map toLower <span class="fu">.</span> filter isAlpha) string
  <span class="kw">where</span> go _ <span class="st">&quot;&quot;</span> <span class="fu">=</span> <span class="st">&quot;&quot;</span>
        go n (c<span class="fu">:</span>cs) <span class="fu">=</span> chr ((ord c <span class="fu">+</span> n <span class="fu">-</span> ord <span class="ch">'a'</span>) <span class="ot">`mod`</span> <span class="dv">26</span> <span class="fu">+</span> ord <span class="ch">'a'</span>) <span class="fu">:</span> go n cs

<span class="ot">unCaesar ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span>
unCaesar key string <span class="fu">=</span> caesar (negate key) string

<span class="ot">vignere ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span>
vignere key cleartext <span class="fu">=</span> map caeserHelper <span class="fu">$</span> zip key' clr' <span class="kw">where</span>
    pre <span class="fu">=</span> (map toLower <span class="fu">.</span> filter isAlpha)
    clr' <span class="fu">=</span> (pre cleartext)
    key' <span class="fu">=</span> take (length clr') <span class="fu">$</span> cycle (pre key)
    caeserHelper (a, b) <span class="fu">=</span> chr ((ord a <span class="fu">+</span> ord b <span class="fu">-</span> <span class="dv">2</span><span class="fu">*</span>ord <span class="ch">'a'</span>) <span class="ot">`mod`</span> <span class="dv">26</span> <span class="fu">+</span> ord <span class="ch">'a'</span>)

<span class="ot">unVignere ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span>
unVignere key ciphertext <span class="fu">=</span> map caeserHelper <span class="fu">$</span> zip key' ciphertext <span class="kw">where</span>
    pre <span class="fu">=</span> (map toLower <span class="fu">.</span> filter isAlpha)
    key' <span class="fu">=</span> take (length ciphertext) <span class="fu">$</span> cycle (pre key)
    caeserHelper (a, b) <span class="fu">=</span> chr ((ord b <span class="fu">-</span> ord a) <span class="ot">`mod`</span> <span class="dv">26</span> <span class="fu">+</span> ord <span class="ch">'a'</span>)

<span class="ot">testCaesar ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>
testCaesar n s <span class="fu">=</span> (map toLower <span class="fu">.</span> filter isAlpha) s <span class="fu">==</span> (unCaesar n <span class="fu">.</span> caesar n) s

<span class="ot">testVignere ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>
testVignere key s <span class="fu">=</span>
  (map toLower <span class="fu">.</span> filter isAlpha) s <span class="fu">==</span> (unVignere key <span class="fu">.</span> vignere key) s

<span class="ot">encrypt ::</span> <span class="dt">IO</span> ()
encrypt <span class="fu">=</span> <span class="kw">do</span>
  putStrLn <span class="st">&quot;Cleartext:&quot;</span>
  clearText <span class="ot">&lt;-</span> getLine
  putStrLn <span class="st">&quot;Caeser Key: &quot;</span>
  cKey <span class="ot">&lt;-</span> getLine
  putStrLn <span class="st">&quot;Vignere Key: &quot;</span>
  vKey <span class="ot">&lt;-</span> getLine
  putStrLn <span class="st">&quot;Caesar Ciphertext is: &quot;</span>
  print (caesar (read cKey) clearText)
  putStrLn <span class="st">&quot;Vignere Ciphertext is: &quot;</span>
  print (vignere vKey clearText)</code></pre></div></li>
<li><div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">--13/ExitSuccess.hs</span>
<span class="kw">module</span> <span class="dt">ExitSuccess</span> <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Data.Char</span>
<span class="kw">import </span><span class="dt">Control.Monad</span>
<span class="kw">import </span><span class="dt">System.Exit</span> (exitSuccess)

<span class="ot">palindrome ::</span> <span class="dt">IO</span> ()
palindrome <span class="fu">=</span> forever <span class="fu">$</span> <span class="kw">do</span>
  line1 <span class="ot">&lt;-</span> getLine
  <span class="kw">if</span> isPalindrome line1
  <span class="kw">then</span> putStrLn <span class="st">&quot;It's a palindrome!&quot;</span>
  <span class="kw">else</span> <span class="kw">do</span> putStrLn <span class="st">&quot;nope&quot;</span>
          exitSuccess

<span class="ot">isPalindrome ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>
isPalindrome str <span class="fu">=</span> (str' <span class="fu">==</span> reverse str')
  <span class="kw">where</span> str' <span class="fu">=</span> filter isAlpha <span class="fu">$</span> map toLower str</code></pre></div></li>
<li><div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">--13/Person.hs</span>
<span class="kw">module</span> <span class="dt">Person</span> <span class="kw">where</span>

<span class="kw">type</span> <span class="dt">Name</span> <span class="fu">=</span> <span class="dt">String</span>
<span class="kw">type</span> <span class="dt">Age</span> <span class="fu">=</span> <span class="dt">Integer</span>

<span class="kw">data</span> <span class="dt">Person</span> <span class="fu">=</span> <span class="dt">Person</span> <span class="dt">Name</span> <span class="dt">Age</span> <span class="kw">deriving</span> <span class="dt">Show</span>
<span class="kw">data</span> <span class="dt">PersonInvalid</span> <span class="fu">=</span> <span class="dt">NameEmpty</span> <span class="fu">|</span> <span class="dt">AgeTooLow</span> <span class="fu">|</span> <span class="dt">Unknown</span> <span class="dt">String</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)

<span class="ot">mkPerson ::</span> <span class="dt">Name</span> <span class="ot">-&gt;</span> <span class="dt">Age</span> <span class="ot">-&gt;</span> <span class="dt">Either</span> <span class="dt">PersonInvalid</span> <span class="dt">Person</span>
mkPerson name age
  <span class="fu">|</span> name <span class="fu">/=</span> <span class="st">&quot;&quot;</span> <span class="fu">&amp;&amp;</span> age <span class="fu">&gt;</span> <span class="dv">0</span> <span class="fu">=</span> <span class="dt">Right</span> <span class="fu">$</span> <span class="dt">Person</span> name age
  <span class="fu">|</span> name <span class="fu">==</span> <span class="st">&quot;&quot;</span>            <span class="fu">=</span> <span class="dt">Left</span> <span class="dt">NameEmpty</span>
  <span class="fu">|</span> not (age <span class="fu">&gt;</span> <span class="dv">0</span>)         <span class="fu">=</span> <span class="dt">Left</span> <span class="dt">AgeTooLow</span>
  <span class="fu">|</span> otherwise             <span class="fu">=</span> <span class="dt">Left</span> <span class="fu">$</span> <span class="dt">Unknown</span> <span class="fu">$</span> <span class="st">&quot;Name was: &quot;</span> <span class="fu">++</span> show name
                                         <span class="fu">++</span> <span class="st">&quot; Age was: &quot;</span>  <span class="fu">++</span> show age

<span class="ot">gimmePerson ::</span> <span class="dt">IO</span> ()
gimmePerson <span class="fu">=</span> <span class="kw">do</span>
  putStrLn <span class="st">&quot;Name: &quot;</span>
  name <span class="ot">&lt;-</span> getLine
  putStrLn <span class="st">&quot;Age: &quot;</span>
  age <span class="ot">&lt;-</span> getLine
  <span class="kw">let</span> person <span class="fu">=</span> mkPerson name (read age) <span class="kw">in</span>
    <span class="kw">case</span> person <span class="kw">of</span>
      (<span class="dt">Left</span> _)  <span class="ot">-&gt;</span> putStrLn (<span class="st">&quot;Invalid person: &quot;</span> <span class="fu">++</span> (show person))
      (<span class="dt">Right</span> _) <span class="ot">-&gt;</span> putStrLn (<span class="st">&quot;Valid person: &quot;</span> <span class="fu">++</span> (show person))

<span class="co">-- best way to handle parse error for read is to change mkPerson</span></code></pre></div></li>
</ol>
<h2 id="follow-up-resources">13.15 Follow-up resources</h2>
<ol style="list-style-type: decimal">
<li><a href="https://github.com/commercialhaskell/stack">Stack</a></li>
<li><a href="http://bitemyapp.com/posts/2014-11-18-how-i-start-haskell.html">How I Start: Haskell</a></li>
<li><a href="https://www.haskell.org/cabal/FAQ.html">Cabal FAQ</a></li>
<li><a href="https://www.haskell.org/cabal/users-guide/">Cabal user’s guide</a></li>
<li><a href="https://www.haskell.org/tutorial/modules.html">A Gentle Introduction to Haskell, Modules chapter.</a></li>
</ol>

        </div>
        <div id="footer">
          <p>&copy; <script>document.write(new Date().getFullYear());</script>
             John Chandler Burnham.
            Generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>
          </p>
        </div>
    </body>
</html>
