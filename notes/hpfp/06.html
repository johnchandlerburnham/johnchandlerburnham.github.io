<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>John Chandler Burnham - Notes (HPFP 06/31): Typeclasses</title>
        <link rel="stylesheet" type="text/css" href="../../css/default.css" />
    </head>
    <body>
        <div id="header">
            <div id="navigation">
                <a href="../../">jcb</a>
                <a href="../../posts.html">posts</a>
                <a href="../../projects.html">projects</a>
                <a href="https://github.com/johnchandlerburnham">github</a>
                <a href="https://twitter.com/John_C_Burnham">twitter</a>
            </div>
        </div>
        <div id="content">
            <h1>Notes (HPFP 06/31): Typeclasses</h1>
          <div id="title" class="info">
    Posted on November  1, 2017
    
        by jcb
    
<hr>
</div>

<h1 id="typeclasses">6 Typeclasses</h1>
<h2 id="what-are-typeclasses">6.2 What are typeclasses?</h2>
<p>“Typeclasses and types in Haskell are, in a sense, opposites”.</p>
<p>Sentences like these frustrate me. You can say nearly anything is the case “in a sense:”</p>
<p>“In a sense, the Moon really is made of cheese.” In the sense of poetic whimsy.</p>
<p>“In a sense, Johnny is at the top of his class.” In unexcused absences and missed assignments.</p>
<p>This is just some plain old fashioned Jesuitical casuistry. Annoying.</p>
<p>“In a sense, typeclasses and types are the same.” In the sense that they both specify and constrain the properties of expressions.</p>
<p>If an expression’s type is an instance of <code>Eq</code> it means there’s a way to define to define and equals function <code>(==)</code> to check if two expressions of that type are equal:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="dt">Prelude</span><span class="fu">&gt;</span> <span class="fu">:</span>info <span class="dt">Eq</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">class</span> <span class="dt">Eq</span> a <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="ot">  (==) ::</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="ot">  (/=) ::</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  <span class="ot">{-# MINIMAL (==) | (/=) #-}</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">    <span class="co">-- Defined in ‘GHC.Classes’</span></a></code></pre></div>
<p>But there are types that it is impossible to define <code>(==)</code> for! The function constructor <code>(-&gt;)</code>, for example, cannot be an instance of <code>Eq</code>. Why? The Halting Problem! If there’s no general way to test whether a function will halt on a given input, there’s certainly no general way to determine whether two functions will do the same thing (run forever or return the same value) for a given input.</p>
<p>So typeclasses constrains the potential things types can be by specifying what they can do.</p>
<p>Some typeclasses and their relationships:</p>
<p align="center">
<img src="https://wiki.haskell.org/wikiupload/d/df/Typeclassopedia-diagram.png" width="600px" alt="Typeclassopedia">
</p>
<h2 id="exercises-eq-instances">Exercises: Eq Instances</h2>
<ol type="1">
<li><div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">Eq</span> <span class="dt">TisAnInteger</span> <span class="kw">where</span> (<span class="fu">==</span>) <span class="dt">TisAn</span> x <span class="dt">TisAn</span> y <span class="fu">=</span> (<span class="fu">==</span>) x y</a></code></pre></div></li>
<li><div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">Eq</span> <span class="dt">TwoIntegers</span> <span class="kw">where</span> <span class="dt">Two</span> x y <span class="fu">==</span> <span class="dt">Two</span> p q <span class="fu">=</span> (x, y) <span class="fu">==</span> (p, q)</a></code></pre></div></li>
<li><p>String or Int:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">Eq</span> <span class="dt">StringOrInt</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="dt">TisAnInt</span> x <span class="fu">==</span> <span class="dt">TisAnInt</span> y <span class="fu">=</span> x <span class="fu">==</span> y</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="dt">TisAString</span> x <span class="fu">==</span> <span class="dt">TisAString</span> y <span class="fu">=</span> x <span class="fu">==</span> y</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">_ <span class="fu">==</span> _ <span class="fu">=</span> <span class="dt">False</span></a></code></pre></div></li>
<li><div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">Eq</span> <span class="dt">Pair</span> <span class="kw">where</span> <span class="dt">Pair</span> a b <span class="fu">==</span> <span class="dt">Pair</span> x y <span class="fu">=</span> (a, b) <span class="fu">==</span> (x, y)</a></code></pre></div></li>
<li><div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">Eq</span> <span class="dt">Tuple</span> <span class="kw">where</span> <span class="dt">Tuple</span> a b <span class="fu">==</span> <span class="dt">Tuple</span> x y <span class="fu">=</span> (a, b) <span class="fu">==</span> (x, y)</a></code></pre></div></li>
<li><p>Which</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">Eq</span> a <span class="ot">=&gt;</span> <span class="dt">Eq</span> (<span class="dt">Which</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="dt">ThisOne</span> x <span class="fu">==</span> <span class="dt">ThisOne</span> y <span class="fu">=</span> x <span class="fu">==</span> y</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="dt">ThatOne</span> x <span class="fu">==</span> <span class="dt">ThatOne</span> y <span class="fu">=</span> x <span class="fu">==</span> y</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">_ <span class="fu">==</span> _ <span class="fu">=</span> <span class="dt">False</span></a></code></pre></div></li>
<li><p>EitherOr</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">instance</span> (<span class="dt">Eq</span> a, <span class="dt">Eq</span> b) <span class="ot">=&gt;</span> <span class="dt">Eq</span> (<span class="dt">EitherOr</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="dt">Hello</span> x <span class="fu">==</span> <span class="dt">Hello</span> y <span class="fu">=</span> x <span class="fu">==</span> y</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="dt">Goodbye</span> x <span class="fu">==</span> <span class="dt">Goodbye</span> y <span class="fu">=</span> x <span class="fu">==</span> y</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">_ <span class="fu">==</span> _ <span class="fu">=</span> <span class="dt">False</span></a></code></pre></div></li>
</ol>
<h2 id="exercises-tuple-experiment">Exercises: Tuple Experiment</h2>
<p><code>quotRem</code> and <code>divMod</code> return a tuple with the values from <code>quot</code> and <code>rem</code> or <code>div</code> and <code>mod</code> respectively.</p>
<h2 id="exercises-will-they-work">Exercises: Will They Work?</h2>
<ol type="1">
<li><code>5</code></li>
<li><code>LT</code></li>
<li>error, a string and a bool are not comparable</li>
<li><code>False</code></li>
</ol>
<h2 id="chapter-exercises">Chapter Exercises</h2>
<h3 id="multiple-choice">Multiple choice</h3>
<ol type="1">
<li>c</li>
<li>b</li>
<li>a</li>
<li>c</li>
<li>a</li>
</ol>
<h3 id="does-it-typecheck">Does it typecheck?:</h3>
<ol type="1">
<li>ch6/ex1.hs</li>
<li><p>ch6/ex2.hs</p></li>
<li><ol type="a">
<li>any <code>Mood</code>, i.e. <code>Blah</code> or <code>Woot</code></li>
<li>type error, <code>9</code> is not a <code>Mood</code></li>
<li><code>Mood</code> does not derive <code>Ord</code></li>
</ol></li>
<li><p>ch6/ex4.hs</p></li>
</ol>
<h3 id="given-a-datatype-declaration-what-can-we-do">Given a datatype declaration, what can we do?</h3>
<p>exdatatype.hs</p>
<ol type="1">
<li><code>&quot;chases&quot;</code> and <code>True</code> are a <code>String</code> and a <code>Bool</code>, not a <code>Rocks</code> and a <code>Yeah</code></li>
<li>works</li>
<li>works</li>
<li><code>Papu</code> isn’t an instance of <code>Ord</code></li>
</ol>
<h3 id="match-the-types">Match the types:</h3>
<p>exmatch1.hs and exmatch2.hs</p>
<ol type="1">
<li>Since <code>i = 1</code>, <code>i</code> has to be a <code>Num</code>, it can’t be a type that <code>1</code> isn’t, like e.g. a <code>String</code>. We can’t cast <code>i</code> upwards.</li>
<li><code>1.0</code> is not just any instance of <code>Num</code>, the syntax implies <code>Fractional</code>.</li>
<li>works</li>
<li>works</li>
<li>works, we can always cast downwards</li>
<li>works</li>
<li>Doesn’t work, <code>sigmund</code> returns <code>myX</code> which is an <code>Int</code></li>
<li>Doesn’t work, <code>sigmund'</code> returns an <code>Int</code> not any instance of <code>Num</code></li>
<li>Works, restricts <code>jung</code> to a list of <code>Ints</code> rather than any list</li>
<li>Works, restricts input to <code>String</code></li>
<li>Doesn’t work, <code>mySort</code> only sorts <code>Strings</code>, not any instance of <code>Ord</code></li>
</ol>
<h3 id="type-kwon-do-electric-typealoo">Type-Kwon-Do: Electric Typealoo</h3>
<ol type="1">
<li><code>chk f a b = f a == b</code></li>
<li><code>arith f n a = (+ fromIntegral n) (f a)</code></li>
</ol>
<h2 id="follow-up-resources">6.17 Follow-up resources</h2>
<ol type="1">
<li><p><a href="https://github.com/johnchandlerburnham/hpffp-resources/blob/master/Chapter-06/How%20to%20make%20ad-hoc%20polymorphism%20less%20ad%20hoc.pdfk">P. Wadler and S. Blott. How to make ad-hoc polymorphism less ad hoc.</a></p></li>
<li><p><a href="https://github.com/johnchandlerburnham/hpffp-resources/blob/master/Chapter-06/Type%20Classes%20in%20Haskell.pdf">Cordelia V. Hall, Kevin Hammond, Simon L. Peyton Jones, and Philip L. Wadler. Typeclasses in Haskell.</a></p></li>
</ol>
<hr />

        </div>
        <div id="footer">
          <p>&copy; <script>document.write(new Date().getFullYear());</script>
             John Chandler Burnham.
            Generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>
          </p>
        </div>
    </body>
</html>
