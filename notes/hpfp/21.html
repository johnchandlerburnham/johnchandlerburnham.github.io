<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>John Chandler Burnham - Notes (HPFP 21/31): Traversable</title>
        <link rel="stylesheet" type="text/css" href="../../css/default.css" />
    </head>
    <body>
        <div id="header">
            <div id="navigation">
                <a href="../../">jcb</a>
                <a href="../../posts.html">posts</a>
                <a href="../../projects.html">projects</a>
                <a href="https://github.com/johnchandlerburnham">github</a>
                <a href="https://twitter.com/John_C_Burnham">twitter</a>
            </div>
        </div>
        <div id="content">
            <h1>Notes (HPFP 21/31): Traversable</h1>
          <div id="title" class="info">
    Posted on November  1, 2017
    
        by jcb
    
<hr>
</div>

<h1 id="traversable">21 Traversable</h1>
<h2 id="chapter-exercises">21.12 Chapter Exercises</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">--21/traversable/src/TraversableInstances.hs</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">module</span> <span class="dt">TraversableInstances</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Test.QuickCheck</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">import</span> <span class="dt">Test.QuickCheck.Classes</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">import</span> <span class="dt">Test.QuickCheck.Checkers</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">import</span> <span class="dt">Data.Monoid</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">-- Identity</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">newtype</span> <span class="dt">Identity</span> a <span class="fu">=</span> <span class="dt">Identity</span> a <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Ord</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">instance</span> <span class="dt">Functor</span> <span class="dt">Identity</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"> fmap f (<span class="dt">Identity</span> a) <span class="fu">=</span> <span class="dt">Identity</span> (f a)</a>
<a class="sourceLine" id="cb1-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw">instance</span> <span class="dt">Foldable</span> <span class="dt">Identity</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">  foldMap f (<span class="dt">Identity</span> a) <span class="fu">=</span> (f a)</a>
<a class="sourceLine" id="cb1-17" data-line-number="17"></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="kw">instance</span> <span class="dt">Traversable</span> <span class="dt">Identity</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">  traverse f (<span class="dt">Identity</span> a) <span class="fu">=</span> fmap <span class="dt">Identity</span> (f a)</a>
<a class="sourceLine" id="cb1-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="kw">instance</span> <span class="dt">Arbitrary</span> a <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Identity</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22">  arbitrary <span class="fu">=</span> <span class="dt">Identity</span> <span class="fu">&lt;$&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb1-23" data-line-number="23"></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="kw">instance</span> <span class="dt">Eq</span> a <span class="ot">=&gt;</span> <span class="dt">EqProp</span> (<span class="dt">Identity</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25">  (<span class="fu">=-=</span>) <span class="fu">=</span> eq</a>
<a class="sourceLine" id="cb1-26" data-line-number="26"></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">-- Constant</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="kw">newtype</span> <span class="dt">Constant</span> a b <span class="fu">=</span> <span class="dt">Constant</span> {<span class="ot"> getConstant ::</span> a } <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Ord</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb1-29" data-line-number="29"></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="kw">instance</span> <span class="dt">Functor</span> (<span class="dt">Constant</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31">  fmap _ (<span class="dt">Constant</span> a) <span class="fu">=</span> <span class="dt">Constant</span> a</a>
<a class="sourceLine" id="cb1-32" data-line-number="32"></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="kw">instance</span> <span class="dt">Foldable</span> (<span class="dt">Constant</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34">  foldMap _ _  <span class="fu">=</span> mempty</a>
<a class="sourceLine" id="cb1-35" data-line-number="35"></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="kw">instance</span> <span class="dt">Traversable</span> (<span class="dt">Constant</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37">  traverse f (<span class="dt">Constant</span> a) <span class="fu">=</span> pure <span class="fu">$</span> <span class="dt">Constant</span> a</a>
<a class="sourceLine" id="cb1-38" data-line-number="38"></a>
<a class="sourceLine" id="cb1-39" data-line-number="39"><span class="kw">instance</span> <span class="dt">Arbitrary</span> a <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Constant</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40">  arbitrary <span class="fu">=</span> <span class="dt">Constant</span> <span class="fu">&lt;$&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb1-41" data-line-number="41"></a>
<a class="sourceLine" id="cb1-42" data-line-number="42"><span class="kw">instance</span> <span class="dt">Eq</span> a <span class="ot">=&gt;</span> <span class="dt">EqProp</span> (<span class="dt">Constant</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-43" data-line-number="43">  (<span class="fu">=-=</span>) <span class="fu">=</span> eq</a>
<a class="sourceLine" id="cb1-44" data-line-number="44"></a>
<a class="sourceLine" id="cb1-45" data-line-number="45"><span class="co">-- Maybe</span></a>
<a class="sourceLine" id="cb1-46" data-line-number="46"></a>
<a class="sourceLine" id="cb1-47" data-line-number="47"><span class="kw">data</span> <span class="dt">Optional</span> a <span class="fu">=</span> <span class="dt">Nada</span> <span class="fu">|</span> <span class="dt">Yep</span> a <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Ord</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb1-48" data-line-number="48"></a>
<a class="sourceLine" id="cb1-49" data-line-number="49"><span class="kw">instance</span> <span class="dt">Functor</span> <span class="dt">Optional</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-50" data-line-number="50">  fmap f <span class="dt">Nada</span> <span class="fu">=</span> <span class="dt">Nada</span></a>
<a class="sourceLine" id="cb1-51" data-line-number="51">  fmap f (<span class="dt">Yep</span> a) <span class="fu">=</span> <span class="dt">Yep</span> (f a)</a>
<a class="sourceLine" id="cb1-52" data-line-number="52"></a>
<a class="sourceLine" id="cb1-53" data-line-number="53"><span class="kw">instance</span> <span class="dt">Foldable</span> <span class="dt">Optional</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-54" data-line-number="54">  foldMap f <span class="dt">Nada</span> <span class="fu">=</span> mempty</a>
<a class="sourceLine" id="cb1-55" data-line-number="55">  foldMap f (<span class="dt">Yep</span> a) <span class="fu">=</span> (f a)</a>
<a class="sourceLine" id="cb1-56" data-line-number="56"></a>
<a class="sourceLine" id="cb1-57" data-line-number="57"><span class="kw">instance</span> <span class="dt">Traversable</span> <span class="dt">Optional</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-58" data-line-number="58">  traverse f <span class="dt">Nada</span> <span class="fu">=</span> pure <span class="dt">Nada</span></a>
<a class="sourceLine" id="cb1-59" data-line-number="59">  traverse f (<span class="dt">Yep</span> a) <span class="fu">=</span> fmap <span class="dt">Yep</span> (f a)</a>
<a class="sourceLine" id="cb1-60" data-line-number="60"></a>
<a class="sourceLine" id="cb1-61" data-line-number="61"><span class="kw">instance</span> <span class="dt">Arbitrary</span> a <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Optional</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-62" data-line-number="62">  arbitrary <span class="fu">=</span> oneof [<span class="dt">Yep</span> <span class="fu">&lt;$&gt;</span> arbitrary, return <span class="dt">Nada</span>]</a>
<a class="sourceLine" id="cb1-63" data-line-number="63"></a>
<a class="sourceLine" id="cb1-64" data-line-number="64"><span class="kw">instance</span> <span class="dt">Eq</span> a <span class="ot">=&gt;</span> <span class="dt">EqProp</span> (<span class="dt">Optional</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-65" data-line-number="65">  (<span class="fu">=-=</span>) <span class="fu">=</span> eq</a>
<a class="sourceLine" id="cb1-66" data-line-number="66"></a>
<a class="sourceLine" id="cb1-67" data-line-number="67"><span class="co">-- List</span></a>
<a class="sourceLine" id="cb1-68" data-line-number="68"></a>
<a class="sourceLine" id="cb1-69" data-line-number="69"><span class="kw">data</span> <span class="dt">List</span> a <span class="fu">=</span> <span class="dt">Nil</span> <span class="fu">|</span> <span class="dt">Cons</span> a (<span class="dt">List</span> a) <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>, <span class="dt">Ord</span>)</a>
<a class="sourceLine" id="cb1-70" data-line-number="70"></a>
<a class="sourceLine" id="cb1-71" data-line-number="71"><span class="kw">instance</span> <span class="dt">Functor</span> <span class="dt">List</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-72" data-line-number="72">  fmap f <span class="dt">Nil</span> <span class="fu">=</span> <span class="dt">Nil</span></a>
<a class="sourceLine" id="cb1-73" data-line-number="73">  fmap f (<span class="dt">Cons</span> x xs) <span class="fu">=</span> <span class="dt">Cons</span> (f x) <span class="fu">$</span> fmap f xs</a>
<a class="sourceLine" id="cb1-74" data-line-number="74"></a>
<a class="sourceLine" id="cb1-75" data-line-number="75"><span class="kw">instance</span> <span class="dt">Foldable</span> <span class="dt">List</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-76" data-line-number="76">  foldMap f <span class="dt">Nil</span> <span class="fu">=</span> mempty</a>
<a class="sourceLine" id="cb1-77" data-line-number="77">  foldMap f (<span class="dt">Cons</span> x xs) <span class="fu">=</span> (f x) <span class="fu">&lt;&gt;</span> (foldMap f xs)</a>
<a class="sourceLine" id="cb1-78" data-line-number="78"></a>
<a class="sourceLine" id="cb1-79" data-line-number="79"><span class="kw">instance</span> <span class="dt">Traversable</span> <span class="dt">List</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-80" data-line-number="80">  traverse f <span class="dt">Nil</span> <span class="fu">=</span> pure <span class="dt">Nil</span></a>
<a class="sourceLine" id="cb1-81" data-line-number="81">  traverse f (<span class="dt">Cons</span> x xs) <span class="fu">=</span> <span class="dt">Cons</span> <span class="fu">&lt;$&gt;</span> (f x) <span class="fu">&lt;*&gt;</span> (traverse f xs)</a>
<a class="sourceLine" id="cb1-82" data-line-number="82"></a>
<a class="sourceLine" id="cb1-83" data-line-number="83"><span class="kw">instance</span> <span class="dt">Arbitrary</span> a <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">List</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-84" data-line-number="84">  arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-85" data-line-number="85">   x <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb1-86" data-line-number="86">   xs <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb1-87" data-line-number="87">   oneof [return <span class="dt">Nil</span>, return (<span class="dt">Cons</span> x xs)]</a>
<a class="sourceLine" id="cb1-88" data-line-number="88"></a>
<a class="sourceLine" id="cb1-89" data-line-number="89"><span class="kw">instance</span> <span class="dt">Eq</span> a <span class="ot">=&gt;</span> <span class="dt">EqProp</span> (<span class="dt">List</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-90" data-line-number="90">  (<span class="fu">=-=</span>) <span class="fu">=</span> eq</a>
<a class="sourceLine" id="cb1-91" data-line-number="91"></a>
<a class="sourceLine" id="cb1-92" data-line-number="92"><span class="kw">data</span> <span class="dt">Three</span> a b c <span class="fu">=</span> <span class="dt">Three</span> a b c <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>, <span class="dt">Ord</span>)</a>
<a class="sourceLine" id="cb1-93" data-line-number="93"></a>
<a class="sourceLine" id="cb1-94" data-line-number="94"><span class="kw">instance</span> <span class="dt">Functor</span> (<span class="dt">Three</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-95" data-line-number="95"> fmap f (<span class="dt">Three</span> a b c) <span class="fu">=</span> <span class="dt">Three</span> a b (f c)</a>
<a class="sourceLine" id="cb1-96" data-line-number="96"></a>
<a class="sourceLine" id="cb1-97" data-line-number="97"><span class="kw">instance</span> <span class="dt">Foldable</span> (<span class="dt">Three</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-98" data-line-number="98">  foldMap f (<span class="dt">Three</span> a b c) <span class="fu">=</span> (f c)</a>
<a class="sourceLine" id="cb1-99" data-line-number="99"></a>
<a class="sourceLine" id="cb1-100" data-line-number="100"><span class="kw">instance</span> <span class="dt">Traversable</span> (<span class="dt">Three</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-101" data-line-number="101">  traverse f (<span class="dt">Three</span> a b c) <span class="fu">=</span> fmap (<span class="dt">Three</span> a b) (f c)</a>
<a class="sourceLine" id="cb1-102" data-line-number="102"></a>
<a class="sourceLine" id="cb1-103" data-line-number="103"><span class="kw">instance</span> (<span class="dt">Arbitrary</span> a, <span class="dt">Arbitrary</span> b, <span class="dt">Arbitrary</span> c) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Three</span> a b c) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-104" data-line-number="104">  arbitrary <span class="fu">=</span> <span class="dt">Three</span> <span class="fu">&lt;$&gt;</span> arbitrary <span class="fu">&lt;*&gt;</span> arbitrary <span class="fu">&lt;*&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb1-105" data-line-number="105"></a>
<a class="sourceLine" id="cb1-106" data-line-number="106"><span class="kw">instance</span> (<span class="dt">Eq</span> a, <span class="dt">Eq</span> b, <span class="dt">Eq</span> c) <span class="ot">=&gt;</span> <span class="dt">EqProp</span> (<span class="dt">Three</span> a b c) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-107" data-line-number="107">  (<span class="fu">=-=</span>) <span class="fu">=</span> eq</a>
<a class="sourceLine" id="cb1-108" data-line-number="108"></a>
<a class="sourceLine" id="cb1-109" data-line-number="109"><span class="co">-- Pair</span></a>
<a class="sourceLine" id="cb1-110" data-line-number="110"></a>
<a class="sourceLine" id="cb1-111" data-line-number="111"><span class="kw">data</span> <span class="dt">Pair</span> a b <span class="fu">=</span> <span class="dt">Pair</span> a b <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>, <span class="dt">Ord</span>)</a>
<a class="sourceLine" id="cb1-112" data-line-number="112"></a>
<a class="sourceLine" id="cb1-113" data-line-number="113"><span class="kw">instance</span> <span class="dt">Functor</span> (<span class="dt">Pair</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-114" data-line-number="114">  fmap f (<span class="dt">Pair</span> a b) <span class="fu">=</span> <span class="dt">Pair</span> a (f b)</a>
<a class="sourceLine" id="cb1-115" data-line-number="115"></a>
<a class="sourceLine" id="cb1-116" data-line-number="116"><span class="kw">instance</span> <span class="dt">Foldable</span> (<span class="dt">Pair</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-117" data-line-number="117">  foldMap f (<span class="dt">Pair</span> a b) <span class="fu">=</span> (f b)</a>
<a class="sourceLine" id="cb1-118" data-line-number="118"></a>
<a class="sourceLine" id="cb1-119" data-line-number="119"><span class="kw">instance</span> <span class="dt">Traversable</span> (<span class="dt">Pair</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-120" data-line-number="120">  traverse f (<span class="dt">Pair</span> a b) <span class="fu">=</span> fmap (<span class="dt">Pair</span> a) (f b)</a>
<a class="sourceLine" id="cb1-121" data-line-number="121"></a>
<a class="sourceLine" id="cb1-122" data-line-number="122"><span class="kw">instance</span> (<span class="dt">Arbitrary</span> a, <span class="dt">Arbitrary</span> b) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Pair</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-123" data-line-number="123">  arbitrary <span class="fu">=</span> <span class="dt">Pair</span> <span class="fu">&lt;$&gt;</span> arbitrary <span class="fu">&lt;*&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb1-124" data-line-number="124"></a>
<a class="sourceLine" id="cb1-125" data-line-number="125"><span class="kw">instance</span> (<span class="dt">Eq</span> a, <span class="dt">Eq</span> b) <span class="ot">=&gt;</span> <span class="dt">EqProp</span> (<span class="dt">Pair</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-126" data-line-number="126">  (<span class="fu">=-=</span>) <span class="fu">=</span> eq</a>
<a class="sourceLine" id="cb1-127" data-line-number="127"></a>
<a class="sourceLine" id="cb1-128" data-line-number="128"><span class="co">-- Big</span></a>
<a class="sourceLine" id="cb1-129" data-line-number="129"><span class="kw">data</span> <span class="dt">Big</span> a b <span class="fu">=</span> <span class="dt">Big</span> a b b <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>, <span class="dt">Ord</span>)</a>
<a class="sourceLine" id="cb1-130" data-line-number="130"></a>
<a class="sourceLine" id="cb1-131" data-line-number="131"><span class="kw">instance</span> <span class="dt">Functor</span> (<span class="dt">Big</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-132" data-line-number="132">  fmap f (<span class="dt">Big</span> a b c) <span class="fu">=</span> <span class="dt">Big</span> a (f b) (f c)</a>
<a class="sourceLine" id="cb1-133" data-line-number="133"></a>
<a class="sourceLine" id="cb1-134" data-line-number="134"><span class="kw">instance</span> <span class="dt">Foldable</span> (<span class="dt">Big</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-135" data-line-number="135">  foldMap f (<span class="dt">Big</span> a b c) <span class="fu">=</span> (f b) <span class="fu">&lt;&gt;</span> (f c)</a>
<a class="sourceLine" id="cb1-136" data-line-number="136"></a>
<a class="sourceLine" id="cb1-137" data-line-number="137"><span class="kw">instance</span> <span class="dt">Traversable</span> (<span class="dt">Big</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-138" data-line-number="138">  traverse f (<span class="dt">Big</span> a b c) <span class="fu">=</span> (<span class="dt">Big</span> a) <span class="fu">&lt;$&gt;</span> (f b) <span class="fu">&lt;*&gt;</span> (f c)</a>
<a class="sourceLine" id="cb1-139" data-line-number="139"></a>
<a class="sourceLine" id="cb1-140" data-line-number="140"><span class="kw">instance</span> (<span class="dt">Arbitrary</span> a, <span class="dt">Arbitrary</span> b) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Big</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-141" data-line-number="141">  arbitrary <span class="fu">=</span> <span class="dt">Big</span> <span class="fu">&lt;$&gt;</span> arbitrary <span class="fu">&lt;*&gt;</span> arbitrary <span class="fu">&lt;*&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb1-142" data-line-number="142"></a>
<a class="sourceLine" id="cb1-143" data-line-number="143"><span class="kw">instance</span> (<span class="dt">Eq</span> a, <span class="dt">Eq</span> b) <span class="ot">=&gt;</span> <span class="dt">EqProp</span> (<span class="dt">Big</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-144" data-line-number="144">  (<span class="fu">=-=</span>) <span class="fu">=</span> eq</a>
<a class="sourceLine" id="cb1-145" data-line-number="145"></a>
<a class="sourceLine" id="cb1-146" data-line-number="146"><span class="co">-- Bigger</span></a>
<a class="sourceLine" id="cb1-147" data-line-number="147"><span class="kw">data</span> <span class="dt">Bigger</span> a b <span class="fu">=</span> <span class="dt">Bigger</span> a b b b <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>, <span class="dt">Ord</span>)</a>
<a class="sourceLine" id="cb1-148" data-line-number="148"></a>
<a class="sourceLine" id="cb1-149" data-line-number="149"><span class="kw">instance</span> <span class="dt">Functor</span> (<span class="dt">Bigger</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-150" data-line-number="150">  fmap f (<span class="dt">Bigger</span> a b c d) <span class="fu">=</span> <span class="dt">Bigger</span> a (f b) (f c) (f d)</a>
<a class="sourceLine" id="cb1-151" data-line-number="151"></a>
<a class="sourceLine" id="cb1-152" data-line-number="152"><span class="kw">instance</span> <span class="dt">Foldable</span> (<span class="dt">Bigger</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-153" data-line-number="153">  foldMap f (<span class="dt">Bigger</span> a b c d) <span class="fu">=</span> (f b) <span class="fu">&lt;&gt;</span> (f c) <span class="fu">&lt;&gt;</span> (f d)</a>
<a class="sourceLine" id="cb1-154" data-line-number="154"></a>
<a class="sourceLine" id="cb1-155" data-line-number="155"><span class="kw">instance</span> <span class="dt">Traversable</span> (<span class="dt">Bigger</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-156" data-line-number="156">  traverse f (<span class="dt">Bigger</span> a b c d) <span class="fu">=</span> (<span class="dt">Bigger</span> a) <span class="fu">&lt;$&gt;</span> (f b) <span class="fu">&lt;*&gt;</span> (f c) <span class="fu">&lt;*&gt;</span> (f d)</a>
<a class="sourceLine" id="cb1-157" data-line-number="157"></a>
<a class="sourceLine" id="cb1-158" data-line-number="158"><span class="kw">instance</span> (<span class="dt">Arbitrary</span> a, <span class="dt">Arbitrary</span> b) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Bigger</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-159" data-line-number="159">  arbitrary <span class="fu">=</span> <span class="dt">Bigger</span> <span class="fu">&lt;$&gt;</span> arbitrary <span class="fu">&lt;*&gt;</span> arbitrary <span class="fu">&lt;*&gt;</span> arbitrary <span class="fu">&lt;*&gt;</span> arbitrary</a>
<a class="sourceLine" id="cb1-160" data-line-number="160"></a>
<a class="sourceLine" id="cb1-161" data-line-number="161"><span class="kw">instance</span> (<span class="dt">Eq</span> a, <span class="dt">Eq</span> b) <span class="ot">=&gt;</span> <span class="dt">EqProp</span> (<span class="dt">Bigger</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-162" data-line-number="162">  (<span class="fu">=-=</span>) <span class="fu">=</span> eq</a>
<a class="sourceLine" id="cb1-163" data-line-number="163"></a>
<a class="sourceLine" id="cb1-164" data-line-number="164"><span class="co">-- Testing</span></a>
<a class="sourceLine" id="cb1-165" data-line-number="165"><span class="kw">type</span> <span class="dt">IIL</span> <span class="fu">=</span> (<span class="dt">Int</span>, <span class="dt">Int</span>, [<span class="dt">Int</span>])</a>
<a class="sourceLine" id="cb1-166" data-line-number="166"></a>
<a class="sourceLine" id="cb1-167" data-line-number="167">main <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb1-168" data-line-number="168">  quickBatch (traversable (undefined<span class="ot"> ::</span> <span class="dt">Identity</span> <span class="dt">IIL</span>))</a>
<a class="sourceLine" id="cb1-169" data-line-number="169">  quickBatch (traversable (undefined<span class="ot"> ::</span> <span class="dt">Constant</span> <span class="dt">IIL</span> <span class="dt">IIL</span>))</a>
<a class="sourceLine" id="cb1-170" data-line-number="170">  quickBatch (traversable (undefined<span class="ot"> ::</span> <span class="dt">Optional</span> <span class="dt">IIL</span>))</a>
<a class="sourceLine" id="cb1-171" data-line-number="171">  quickBatch (traversable (undefined<span class="ot"> ::</span> <span class="dt">List</span> <span class="dt">IIL</span>))</a>
<a class="sourceLine" id="cb1-172" data-line-number="172">  quickBatch (traversable (undefined<span class="ot"> ::</span> <span class="dt">Three</span> <span class="dt">IIL</span> <span class="dt">IIL</span> <span class="dt">IIL</span>))</a>
<a class="sourceLine" id="cb1-173" data-line-number="173">  quickBatch (traversable (undefined<span class="ot"> ::</span> <span class="dt">Pair</span> <span class="dt">IIL</span> <span class="dt">IIL</span>))</a>
<a class="sourceLine" id="cb1-174" data-line-number="174">  quickBatch (traversable (undefined<span class="ot"> ::</span> <span class="dt">Big</span> <span class="dt">IIL</span> <span class="dt">IIL</span>))</a>
<a class="sourceLine" id="cb1-175" data-line-number="175">  quickBatch (traversable (undefined<span class="ot"> ::</span> <span class="dt">Bigger</span> <span class="dt">IIL</span> <span class="dt">IIL</span>))</a></code></pre></div>
<h2 id="follow-up-resources">21.13 Follow-up resources</h2>
<ol type="1">
<li>Foldable and Traversable; Jakub Arnold. 2.The Essence of the Iterator Pattern; Jeremy Gibbons and Bruno Oliveira. 3.Applicative Programming with Effects; Conor McBride and Ross Paterson.</li>
</ol>
<hr />

        </div>
        <div id="footer">
          <p>&copy; <script>document.write(new Date().getFullYear());</script>
             John Chandler Burnham.
            Generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>
          </p>
        </div>
    </body>
</html>
