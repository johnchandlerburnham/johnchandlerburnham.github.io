<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>John Chandler Burnham - Notes (HPFP 07/31): More functional patterns</title>
        <link rel="stylesheet" type="text/css" href="../../css/default.css" />
    </head>
    <body>
        <div id="header">
            <div id="navigation">
                <a href="../../">jcb</a>
                <a href="../../posts.html">posts</a>
                <a href="../../projects.html">projects</a>
                <a href="https://github.com/johnchandlerburnham">github</a>
                <a href="https://twitter.com/John_C_Burnham">twitter</a>
            </div>
        </div>
        <div id="content">
          <div id="title">
            <h1>Notes (HPFP 07/31): More functional patterns</h1>
          </div>
          <div class="info">
    Posted on November  1, 2017
    
        by jcb
    
</div>
<div class="info">
    
    Tags: <a href="../../tags/hpfp.html">hpfp</a>, <a href="../../tags/notes.html">notes</a>, <a href="../../tags/haskell.html">haskell</a>
    
</div>

<hr>

<h1 id="more-functional-patterns">7 More functional patterns</h1>
<h2 id="arguments-and-parameters">7.2 Arguments and parameters</h2>
<p>This section is best understood in the context of the lambda calculus. I recommend reading at least <a href="../../posts/workthrough-lambda-calculus-rojas.html#definition">chapter 1 of my notes on Rojas’ Introduction to the Lambda Calculus</a>.</p>
<h2 id="anonymous-functions">7.3 Anonymous functions</h2>
<h3 id="exercises-grab-bag">Exercises: Grab bag</h3>
<ol style="list-style-type: decimal">
<li>They are all equivalent</li>
<li>d</li>
<li><ol style="list-style-type: lower-alpha">
<li><code>f = \x -&gt; x + 1</code></li>
<li><code>addFive = \x -&gt; \y -&gt; (min x y) + 5</code></li>
<li><code>mflip f x y = f y x</code></li>
</ol></li>
</ol>
<h2 id="pattern-matching">7.4 Pattern matching</h2>
<p>From <a href="https://github.com/johnchandlerburnham/hpffp-resources/blob/master/Chapter-02/How%20to%20desugar%20Haskell%20code.pdf">Gonzalez’s “How to Desugar Haskell Code”</a></p>
<blockquote>
<p>Pattern matching on constructors desugars to case statements:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">f (<span class="dt">Left</span>  l) <span class="fu">=</span> eL
f (<span class="dt">Right</span> r) <span class="fu">=</span> eR

<span class="co">-- ... desugars to:</span>

f x <span class="fu">=</span> <span class="kw">case</span> x <span class="kw">of</span>
    <span class="dt">Left</span>  l <span class="ot">-&gt;</span> eL
    <span class="dt">Right</span> r <span class="ot">-&gt;</span> eR</code></pre></div>
<p>Pattern matching on numeric or string literals desugars to equality tests:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">f <span class="dv">0</span> <span class="fu">=</span> e0
f _ <span class="fu">=</span> e1

<span class="co">-- ... desugars to:</span>
f x <span class="fu">=</span> <span class="kw">if</span> x <span class="fu">==</span> <span class="dv">0</span> <span class="kw">then</span> e0 <span class="kw">else</span> e1

<span class="co">-- ... desugars to:</span>
f x <span class="fu">=</span> <span class="kw">case</span> x <span class="fu">==</span> <span class="dv">0</span> <span class="kw">of</span>
    <span class="dt">True</span>  <span class="ot">-&gt;</span> e0
    <span class="dt">False</span> <span class="ot">-&gt;</span> e1</code></pre></div>
</blockquote>
<h3 id="exercises-variety-pack">Exercises: Variety Pack</h3>
<ol style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li><code>k :: (a, b) -&gt; a</code></li>
<li><code>k2</code> is a <code>String</code>, not the same as <code>k1</code> or <code>k3</code></li>
<li><code>k1</code> and <code>k3</code></li>
</ol></li>
<li><code>f (a, b, c) (d, e, f) = ((a, d), (c, f))</code></li>
</ol>
<h2 id="case-expressions">7.5 Case expressions</h2>
<h3 id="exercises-case-practice">Exercises: Case Practice</h3>
<ol style="list-style-type: decimal">
<li><pre><code>functionC x y = case (x &gt; y) of
  True -&gt; x
  False -&gt; y</code></pre></li>
<li><pre><code>ifEvenAdd2 n =
  case even n
    True -&gt; (n + 2)
    False -&gt; n</code></pre></li>
<li><pre><code>nums x =
  case compare x 0 of
    LT -&gt; -1
    GT -&gt; 1
    EQ -&gt; 0</code></pre></li>
</ol>
<h2 id="higher-order-functions">7.6 Higher-order functions</h2>
<h3 id="exercises-artful-dodgy">Exercises: Artful Dodgy</h3>
<ol start="2" style="list-style-type: decimal">
<li><code>11</code></li>
<li><code>22</code></li>
<li><code>21</code></li>
<li><code>12</code></li>
<li><code>11</code></li>
<li><code>21</code></li>
<li><code>21</code></li>
<li><code>22</code></li>
<li><code>31</code></li>
<li><code>23</code></li>
</ol>
<h2 id="guards">7.7 Guards</h2>
<h3 id="exercises-guard-duty">Exercises: Guard Duty</h3>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">--07/AvgGrade.hs</span>
<span class="kw">module</span> <span class="dt">AvgGrade</span> <span class="kw">where</span>

<span class="ot">avgGrade ::</span> (<span class="dt">Fractional</span> a, <span class="dt">Ord</span> a) <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Char</span>
avgGrade x
  <span class="fu">|</span> y <span class="fu">&gt;=</span> <span class="fl">0.7</span> <span class="fu">=</span> <span class="ch">'C'</span>
  <span class="fu">|</span> y <span class="fu">&gt;=</span> <span class="fl">0.9</span> <span class="fu">=</span> <span class="ch">'A'</span>
  <span class="fu">|</span> y <span class="fu">&gt;=</span> <span class="fl">0.8</span> <span class="fu">=</span> <span class="ch">'B'</span>
  <span class="fu">|</span> y <span class="fu">&gt;=</span> <span class="fl">0.59</span> <span class="fu">=</span> <span class="ch">'D'</span>
  <span class="fu">|</span> otherwise <span class="fu">=</span> <span class="ch">'F'</span>
  <span class="kw">where</span>
    y <span class="fu">=</span> x <span class="fu">/</span> <span class="dv">100</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Can’t do otherwise if theres no wise to other.</li>
<li>No, because the conditions are not exclusive.</li>
<li>b</li>
<li>anything reversible, so lists</li>
<li><code>[a] -&gt; Bool</code></li>
<li>c</li>
<li><code>(Ord a, Num a) =&gt; a</code></li>
<li><code>(Ord a, Num a) =&gt; a -&gt; Bool</code></li>
</ol>
<h2 id="chapter-exercises">7.11 Chapter Exercises</h2>
<h3 id="multiple-choice">Multiple Choice</h3>
<ol style="list-style-type: decimal">
<li>d</li>
<li>b</li>
<li>a</li>
<li>b</li>
<li>a</li>
</ol>
<h3 id="lets-write-code">Let’s write code</h3>
<ol style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li><p><code>tensDigit x = (flip mod) 10 $ fst $ divMod x 10</code></p>
<p>Seems silly to use <code>divMod</code>, when</p>
<p><code>tensDigit' x = (flip mod) 10 $ div x 10</code></p>
<p>works perfectly well.</p></li>
<li><p>Yup.</p></li>
<li><p>Well let’s do this properly:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">-- 07/Digit.hs</span>

<span class="ot">baseDigit ::</span> <span class="dt">Integral</span> a <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Maybe</span> a
baseDigit base digit x
  <span class="fu">|</span> base <span class="fu">==</span> <span class="dv">0</span> <span class="fu">=</span> <span class="dt">Nothing</span>
  <span class="fu">|</span> digit <span class="fu">&lt;</span> <span class="dv">0</span> <span class="fu">=</span> <span class="dt">Nothing</span>
  <span class="fu">|</span> otherwise <span class="fu">=</span> <span class="dt">Just</span> <span class="fu">$</span> (flip mod) base <span class="fu">$</span> div x (base <span class="fu">^</span> digit)</code></pre></div>
<p>So that</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="fu">*</span><span class="dt">Main</span><span class="fu">&gt;</span> baseDigit <span class="dv">10</span> <span class="dv">2</span> <span class="dv">1234</span>
<span class="dt">Just</span> <span class="dv">2</span>
<span class="fu">*</span><span class="dt">Main</span><span class="fu">&gt;</span> baseDigit <span class="dv">10</span> <span class="dv">2</span> <span class="dv">123456</span>
<span class="dt">Just</span> <span class="dv">4</span>
<span class="fu">*</span><span class="dt">Main</span><span class="fu">&gt;</span> baseDigit <span class="dv">10</span> <span class="dv">2</span> <span class="dv">9876543210</span>
<span class="dt">Just</span> <span class="dv">2</span>
<span class="fu">*</span><span class="dt">Main</span><span class="fu">&gt;</span></code></pre></div></li>
</ol></li>
<li><div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">-- 07/FoldBool.hs</span>

<span class="ot">foldBool ::</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> a
foldBool x y b <span class="fu">=</span> <span class="kw">case</span> b <span class="kw">of</span>
   <span class="dt">True</span> <span class="ot">-&gt;</span> x
   <span class="dt">False</span> <span class="ot">-&gt;</span> y

<span class="ot">foldBool2 ::</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> a
foldBool2 x y b
 <span class="fu">|</span> b <span class="fu">==</span> <span class="dt">True</span> <span class="fu">=</span> x
 <span class="fu">|</span> b <span class="fu">==</span> <span class="dt">False</span> <span class="fu">=</span> y</code></pre></div></li>
<li><p><code>g f (a, b) = (f a, b)</code></p></li>
<li><div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">-- 07/arith4.hs</span>

<span class="ot">roundTrip ::</span> (<span class="dt">Show</span> a, <span class="dt">Read</span> a) <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> a
roundTrip a <span class="fu">=</span> read (show a)

<span class="ot">roundTripPF ::</span> (<span class="dt">Show</span> a, <span class="dt">Read</span> a) <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> a
roundTripPF <span class="fu">=</span> (read <span class="fu">.</span> show)

<span class="ot">roundTrip2 ::</span> (<span class="dt">Show</span> a, <span class="dt">Read</span> b) <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> b
roundTrip2 a <span class="fu">=</span> read (show a)

main <span class="fu">=</span> <span class="kw">do</span>
  print (roundTrip2 (<span class="dv">4</span><span class="ot"> ::</span> <span class="dt">Int</span>))
  print (id <span class="dv">4</span>)</code></pre></div></li>
</ol>
<h2 id="follow-up-resources">7.13 Follow-up resources</h2>
<ol style="list-style-type: decimal">
<li><p><a href="https://www.haskell.org/tutorial/patterns.html">Paul Hudak; John Peterson; Joseph Fasel. A Gentle Introduction to Haskell, chapter on case expressions and pattern matching.</a></p></li>
<li><p><a href="http://research.microsoft.com/en-us/um/people/simonpj/papers/slpj-book-1987/index.htm">Simon Peyton Jones. The Implementation of Functional Pro- gramming Languages, pages 53-103.</a></p></li>
<li><a href="http://www.cs.cmu.edu/~crary/819-f09/Strachey67.pdf">Christopher Strachey. Fundamental Concepts in Programming Languages, page 11 for explanation of currying.</a></li>
<li><a href="http://www.di.uminho.pt/~jno/ps/iscalc_1.ps.gz">J.N. Oliveira. An introduction to pointfree programming.</a></li>
<li><p><a href="http://www4.di.uminho.pt/~mac/Publications/phd.pdf">Manuel Alcino Pereira da Cunha. Point-free Program Calculation.</a></p></li>
</ol>
<hr />

        </div>
        <div id="footer">
          <p>&copy; <script>document.write(new Date().getFullYear());</script>
             John Chandler Burnham.
            Generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>
          </p>
        </div>
    </body>
</html>
