<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>John Chandler Burnham - Notes (HPFP 11/31): Algebraic Datatypes</title>
        <link rel="stylesheet" type="text/css" href="../../css/default.css" />
    </head>
    <body>
        <div id="header">
            <div id="navigation">
                <a href="../../">jcb</a>
                <a href="../../posts.html">posts</a>
                <a href="../../projects.html">projects</a>
                <a href="https://github.com/johnchandlerburnham">github</a>
                <a href="https://twitter.com/John_C_Burnham">twitter</a>
            </div>
        </div>
        <div id="content">
            <h1>Notes (HPFP 11/31): Algebraic Datatypes</h1>
          <div id="title" class="info">
    Posted on November  1, 2017
    
        by jcb
    
<hr>
</div>

<h1 id="algebraic-datatypes">11 Algebraic Datatypes</h1>
<h2 id="data-constructors-and-values">11.5 Data constructors and values</h2>
<h3 id="exercises-dog-types">Exercises: Dog Types</h3>
<ol type="1">
<li>type constructor</li>
<li><code>* -&gt; *</code></li>
<li><code>*</code></li>
<li><code>Num a =&gt; Doggies a</code></li>
<li><code>Doggies Integer</code></li>
<li><code>Doggies String</code></li>
<li><code>data constructor (both?)</code></li>
<li><code>a -&gt; DogueDeBordeaux a</code></li>
<li><code>DogueDeBordeaux String</code></li>
</ol>
<h2 id="whats-a-type-and-whats-data">11.6 What’s a type and what’s data?</h2>
<h3 id="exercises-vehicles">Exercises: Vehicles</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">--11/Vehicles.hs</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">module</span> <span class="dt">Vehicles</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">data</span> <span class="dt">Price</span> <span class="fu">=</span> <span class="dt">Price</span> <span class="dt">Integer</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">data</span> <span class="dt">Manufacturer</span> <span class="fu">=</span> <span class="dt">Mini</span> <span class="fu">|</span> <span class="dt">Mazda</span> <span class="fu">|</span> <span class="dt">Tata</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">data</span> <span class="dt">Size</span> <span class="fu">=</span> <span class="dt">Small</span> <span class="fu">|</span> <span class="dt">Medium</span> <span class="fu">|</span> <span class="dt">Large</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">data</span> <span class="dt">Airline</span> <span class="fu">=</span> <span class="dt">PapuAir</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">             <span class="fu">|</span> <span class="dt">CatapultsR'Us</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">             <span class="fu">|</span> <span class="dt">TakeYourChancesUnited</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">             <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">data</span> <span class="dt">Vehicle</span> <span class="fu">=</span> <span class="dt">Car</span> <span class="dt">Manufacturer</span> <span class="dt">Price</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">             <span class="fu">|</span> <span class="dt">Plane</span> <span class="dt">Airline</span> <span class="dt">Size</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">             <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb1-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">myCar <span class="fu">=</span> <span class="dt">Car</span> <span class="dt">Mini</span> (<span class="dt">Price</span> <span class="dv">14000</span>)</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">urCar <span class="fu">=</span> <span class="dt">Car</span> <span class="dt">Mazda</span> (<span class="dt">Price</span> <span class="dv">20000</span>)</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">clownCar <span class="fu">=</span> <span class="dt">Car</span> <span class="dt">Tata</span> (<span class="dt">Price</span> <span class="dv">7000</span>)</a>
<a class="sourceLine" id="cb1-19" data-line-number="19">doge <span class="fu">=</span> <span class="dt">Plane</span> <span class="dt">PapuAir</span> <span class="dt">Small</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">-- 1. Vehicle</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">-- 2</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="ot">isCar ::</span> <span class="dt">Vehicle</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25">isCar (<span class="dt">Car</span> _ _) <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26">isCar _ <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="ot">isPlane ::</span> <span class="dt">Vehicle</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29">isPlane (<span class="dt">Plane</span> _ _) <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30">isPlane _ <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"></a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="ot">areCars ::</span> [<span class="dt">Vehicle</span>] <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33">areCars <span class="fu">=</span> any isCar</a>
<a class="sourceLine" id="cb1-34" data-line-number="34"></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co">-- 3</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="ot">getManu ::</span> <span class="dt">Vehicle</span> <span class="ot">-&gt;</span> <span class="dt">Manufacturer</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38">getManu (<span class="dt">Car</span> manu _) <span class="fu">=</span> manu</a>
<a class="sourceLine" id="cb1-39" data-line-number="39"></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="co">-- 4: non-exhaustive patterns</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"></a>
<a class="sourceLine" id="cb1-42" data-line-number="42"><span class="co">-- 5 see above</span></a></code></pre></div>
<h2 id="what-makes-these-datatypes-algebraic">11.8 What makes these datatypes algebraic?</h2>
<h3 id="exercises-cardinality">Exercises: Cardinality</h3>
<ol type="1">
<li>cardinality is 1</li>
<li><code>3</code></li>
<li><code>2^16 = 65536</code></li>
<li><code>2^64</code></li>
<li><code>Int8</code> is an 8 bit integer. <code>2^8</code> is 256.</li>
</ol>
<h3 id="exercises-for-example">Exercises: For Example</h3>
<ol type="1">
<li><code>MakeExample</code>’s type is <code>Example</code>, <code>Example</code> does not have a type, it is a type</li>
<li><code>Example</code> has data constructor <code>MakeExample</code> with an instance of typeclass <code>Show</code></li>
<li><code>MakeExample</code> is a function from <code>Int</code> to <code>Example</code></li>
</ol>
<h2 id="newtype">11.9 newtype</h2>
<h3 id="exercises-logic-goats">Exercises: Logic Goats</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="ot">{-# LANGUAGE GeneralizedNewtypeDeriving, FlexibleInstances #-}</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">--10/LogicGoats.hs</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">module</span> <span class="dt">LogicGoats</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw">class</span> <span class="dt">TooMany</span> a <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="ot">  tooMany ::</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="kw">instance</span> <span class="dt">TooMany</span> <span class="dt">Int</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">  tooMany n <span class="fu">=</span> n <span class="fu">&gt;</span> <span class="dv">42</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="kw">instance</span> <span class="dt">TooMany</span> (<span class="dt">Int</span>, <span class="dt">String</span>) <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">  tooMany (n, str) <span class="fu">=</span> n <span class="fu">&gt;</span> <span class="dv">42</span> <span class="fu">||</span> (length str) <span class="fu">&gt;</span> <span class="dv">42</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">-- instance TooMany (Int, Int) where</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">-- tooMany (n, m) = n + m &gt; 42</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="kw">instance</span> (<span class="dt">Num</span> a, <span class="dt">TooMany</span> a) <span class="ot">=&gt;</span> <span class="dt">TooMany</span> (a, a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">  tooMany (n, m) <span class="fu">=</span> tooMany (n <span class="fu">+</span> m)</a>
<a class="sourceLine" id="cb2-20" data-line-number="20"></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="kw">newtype</span> <span class="dt">Goats</span> <span class="fu">=</span> <span class="dt">Goats</span> <span class="dt">Int</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>, <span class="dt">TooMany</span>)</a></code></pre></div>
<h2 id="sum-types">11.10 Sum types</h2>
<h3 id="exercises-pity-the-bool">Exercises: Pity the Bool</h3>
<ol type="1">
<li>4, <code>Bool</code> has cardinality 2 and there are 2 <code>Bools</code> in the sum type, so <code>2 + 2 = 4</code></li>
<li>258, the type can either be <code>BoolyBool True</code>, <code>BoolyBool False</code> or a <code>Numba</code>. If you go over the Int8 bounds, you get a compiler warning <code>-Woverflowedliterals</code></li>
</ol>
<h2 id="normal-form">11.12 Normal Form</h2>
<h2 id="exercises-how-does-your-garden-grow">Exercises: How Does Your Garden Grow?</h2>
<ol type="1">
<li><pre><code>data Garden = Gardenia String
            | Daisy String
            | Rose String
            | Lilac String
            deriving Show</code></pre></li>
</ol>
<h2 id="constructing-and-deconstructing-values">11.13 Constructing and deconstructing values</h2>
<h3 id="exercises-programmers">Exercises: Programmers</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">--11/Programmers.hs</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">module</span> <span class="dt">Programmers</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">data</span> <span class="dt">OperatingSystem</span> <span class="fu">=</span> <span class="dt">GnuPlusLinux</span> <span class="fu">|</span> <span class="dt">OpenBSDPlus</span> <span class="fu">|</span> <span class="dt">Mac</span> <span class="fu">|</span> <span class="dt">Windows</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">                        <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="kw">data</span> <span class="dt">ProgrammingLanguage</span> <span class="fu">=</span> <span class="dt">Haskell</span> <span class="fu">|</span> <span class="dt">Agda</span> <span class="fu">|</span> <span class="dt">Idris</span> <span class="fu">|</span> <span class="dt">PureScript</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">                           <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="kw">data</span> <span class="dt">Programmer</span> <span class="fu">=</span> <span class="dt">Programmer</span> {<span class="ot"> os   ::</span> <span class="dt">OperatingSystem</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">                             ,<span class="ot"> lang ::</span> <span class="dt">ProgrammingLanguage</span> }</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">                  <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb4-12" data-line-number="12"></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">-- exercise</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="ot">allOperatingSystems ::</span> [<span class="dt">OperatingSystem</span>]</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">allOperatingSystems <span class="fu">=</span> [ <span class="dt">GnuPlusLinux</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17">                      , <span class="dt">OpenBSDPlus</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18">                      , <span class="dt">Mac</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19">                      , <span class="dt">Windows</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20">                      ]</a>
<a class="sourceLine" id="cb4-21" data-line-number="21"></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="ot">allLanguages ::</span> [<span class="dt">ProgrammingLanguage</span>]</a>
<a class="sourceLine" id="cb4-23" data-line-number="23">allLanguages <span class="fu">=</span> [<span class="dt">Haskell</span>, <span class="dt">Agda</span>, <span class="dt">Idris</span>, <span class="dt">PureScript</span>]</a>
<a class="sourceLine" id="cb4-24" data-line-number="24"></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="ot">allProgrammers ::</span> [<span class="dt">Programmer</span>]</a>
<a class="sourceLine" id="cb4-26" data-line-number="26">allProgrammers <span class="fu">=</span> [(<span class="dt">Programmer</span> os lang) <span class="fu">|</span> os   <span class="ot">&lt;-</span> allOperatingSystems</a>
<a class="sourceLine" id="cb4-27" data-line-number="27">                                       , lang <span class="ot">&lt;-</span> allLanguages ]</a></code></pre></div>
<h2 id="function-type-is-exponential">11.14 Function type is exponential</h2>
<p>Here’s how I visualize why the function type is exponential:</p>
<p>The set theory defintion is, roughly, that a function is a set of pairs of elements some input set <code>A</code> and elements of some ouput set <code>B</code>, such that there for each element <code>a</code> in <code>A</code>, there is one and only one pair <code>(a, _)</code> in <code>f</code> (assuming the function is total).</p>
<p>Suppose we’re considering functions from <code>Bool</code> to <code>Bool</code>. As haskell code:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="ot">f1 ::</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">f1 <span class="dt">True</span> <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">f1 <span class="dt">False</span> <span class="fu">=</span> <span class="dt">True</span></a></code></pre></div>
<p>But written as a set, <code>f1</code> looks like:</p>
<pre><code>{ {T, T},  {F, T} }</code></pre>
<p>Another function <code>f2</code> might be:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="ot">f2 ::</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">f2 <span class="dt">True</span> <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">f2 <span class="dt">False</span> <span class="fu">=</span> <span class="dt">False</span></a></code></pre></div>
<pre><code>{ {T, T},  {F, F} }</code></pre>
<p>So now let’s ask ourselves: How many distinct functions from <code>Bool</code> to <code>Bool</code> are there?</p>
<p>Well, <code>Bool</code> is small so we can just list them out:</p>
<pre><code>{ {T, T},  {F, T} }
{ {T, T},  {F, F} }
{ {T, F},  {F, T} }
{ {T, F},  {F, F} }</code></pre>
<p>So there are four, which from the book makes sense because <code>Bool</code> has a cardinality of 2 and function types as exponentials implies that the cardinality of <code>Bool -&gt; Bool</code> is <code>2^2 = 4</code>.</p>
<p>But, why is this the case? Here’s something interesting, in the listing of possible functions as sets:</p>
<pre><code>{ {T, T},  {F, T} }
{ {T, T},  {F, F} }
{ {T, F},  {F, T} }
{ {T, F},  {F, F} }</code></pre>
<p>We’re actually repeating a lot of information in each line. See how all the <code>T</code>’s and <code>F</code>’s line up? We already know that in each function from <code>Bool</code> there’s going to be a pair with <code>True</code> and a pair with <code>False</code> in the first position. What makes the function unique is really the outputs, not the inputs.</p>
<p>Let’s rewrite the function listing, by picking an order for elements of <code>Bool</code>: True, False.</p>
<p>Then we can rewrite:</p>
<pre><code>{ {T, T},  {F, T} } = TT
{ {T, T},  {F, F} } = TF
{ {T, F},  {F, T} } = FT
{ {T, F},  {F, F} } = FF</code></pre>
<p>As long as we know the ordering <code>True, False</code>, we can figure out that the first symbol in the pair <code>TF</code>, for example, refers to to the output from <code>True</code> and the second symbol refers to the output from <code>False</code>.</p>
<p>In other words, when we look at a function, we can look up the function’s output for a given input by looking at what symbol appears the input’s position in the ordering.</p>
<p>For example, what does the function <code>FT</code> return for the input <code>True</code>? <code>FT</code> has an <code>F</code> for <code>False</code> in the <code>True</code> position, so it returns <code>False</code>.</p>
<p>The function <code>FT</code> and <code>FF</code> are the same in the <code>True</code> position, and differ in the `False position.</p>
<p>This may remind you of how digits work in numbers, except instead of the ones position, tens postion etc, the places represent inputs.</p>
<p>Watch what happens if we map the symbol <code>T</code> to <code>1</code> and the symbol <code>F</code> to <code>0</code>:</p>
<pre><code>TT = 11
TF = 10
FT = 01
FF = 00</code></pre>
<p>These are all the 2 digit binary numbers. There are four of them, because each digit can be either <code>1</code> or <code>0</code>, and there are two digits, so <code>2 symbols ^ 2 digits = 4</code></p>
<p>If there were three digits, there would be <code>2^3 = 8</code> possibile numbers. If there were three digits in base ten there would be <code>10^3 = 1000</code> possible numbers.</p>
<p>The elements of a function’s input set can be mapped to “digit” positions, and the elements of the output set can be mapped to “digit” symbols. Then you can write down a unique representation of the function by writing the ouput symbols in the input positions. Because the number of possible unique representations is the same as the number of possible functions, and because the number of representations is the number of base symbols raised to the number of digits (base ^ digitnumber = uniques), the number of possible unique functions from one set to another is the number elements in the output set raised to the number of element in the input set.</p>
<h2 id="exercises-the-quad">Exercises: The Quad</h2>
<ol type="1">
<li>8</li>
<li>16</li>
<li>4^4 = 256</li>
<li>2<em>2</em>2 = 8</li>
<li>2<sup>2</sup>2 = 16</li>
<li>(4<sup>4)</sup>2 = 65536</li>
</ol>
<h2 id="binary-tree">11.17 Binary Tree</h2>
<h3 id="binarytree">BinaryTree</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">--11/BinaryTree.hs</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">module</span> <span class="dt">BinaryTree</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="kw">data</span> <span class="dt">BinaryTree</span> a <span class="fu">=</span> <span class="dt">Leaf</span> <span class="fu">|</span> <span class="dt">Node</span> (<span class="dt">BinaryTree</span> a) a (<span class="dt">BinaryTree</span> a)</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">                    <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>, <span class="dt">Ord</span>)</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">-- insert</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="ot">insert' ::</span> <span class="dt">Ord</span> a <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> a <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> a</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">insert' b <span class="dt">Leaf</span> <span class="fu">=</span> <span class="dt">Node</span> <span class="dt">Leaf</span> b <span class="dt">Leaf</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9">insert' b (<span class="dt">Node</span> left a right)</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">  <span class="fu">|</span> b <span class="fu">==</span> a <span class="fu">=</span> <span class="dt">Node</span> left a right</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">  <span class="fu">|</span> b <span class="fu">&lt;</span> a  <span class="fu">=</span> <span class="dt">Node</span> (insert' b left) a right</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">  <span class="fu">|</span> b <span class="fu">&gt;</span> a  <span class="fu">=</span> <span class="dt">Node</span> left a (insert' b right)</a>
<a class="sourceLine" id="cb13-13" data-line-number="13"></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="co">-- map</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="ot">mapTree ::</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> a <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> b</a>
<a class="sourceLine" id="cb13-16" data-line-number="16">mapTree _ <span class="dt">Leaf</span> <span class="fu">=</span> <span class="dt">Leaf</span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17">mapTree f (<span class="dt">Node</span> left a right) <span class="fu">=</span> (<span class="dt">Node</span> (mapTree f left) (f a) (mapTree f right))</a>
<a class="sourceLine" id="cb13-18" data-line-number="18"></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="ot">testTree' ::</span> <span class="dt">BinaryTree</span> <span class="dt">Integer</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20">testTree' <span class="fu">=</span> <span class="dt">Node</span> (<span class="dt">Node</span> <span class="dt">Leaf</span> <span class="dv">3</span> <span class="dt">Leaf</span>) <span class="dv">1</span> (<span class="dt">Node</span> <span class="dt">Leaf</span> <span class="dv">4</span> <span class="dt">Leaf</span>)</a>
<a class="sourceLine" id="cb13-21" data-line-number="21"></a>
<a class="sourceLine" id="cb13-22" data-line-number="22">mapExpected <span class="fu">=</span> <span class="dt">Node</span> (<span class="dt">Node</span> <span class="dt">Leaf</span> <span class="dv">4</span> <span class="dt">Leaf</span>) <span class="dv">2</span> (<span class="dt">Node</span> <span class="dt">Leaf</span> <span class="dv">5</span> <span class="dt">Leaf</span>)</a>
<a class="sourceLine" id="cb13-23" data-line-number="23"></a>
<a class="sourceLine" id="cb13-24" data-line-number="24">mapOkay <span class="fu">=</span> mapTree (<span class="fu">+</span><span class="dv">1</span>) testTree' <span class="fu">==</span> mapExpected</a>
<a class="sourceLine" id="cb13-25" data-line-number="25"></a>
<a class="sourceLine" id="cb13-26" data-line-number="26"><span class="co">-- list</span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27"><span class="ot">preorder ::</span> <span class="dt">BinaryTree</span> a <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb13-28" data-line-number="28">preorder <span class="dt">Leaf</span> <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb13-29" data-line-number="29">preorder (<span class="dt">Node</span> left a right) <span class="fu">=</span> [a] <span class="fu">++</span> (preorder left) <span class="fu">++</span> (preorder right)</a>
<a class="sourceLine" id="cb13-30" data-line-number="30"></a>
<a class="sourceLine" id="cb13-31" data-line-number="31"><span class="ot">inorder ::</span> <span class="dt">BinaryTree</span> a <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb13-32" data-line-number="32">inorder <span class="dt">Leaf</span> <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb13-33" data-line-number="33">inorder (<span class="dt">Node</span> left a right) <span class="fu">=</span> (inorder left) <span class="fu">++</span> [a] <span class="fu">++</span>  (inorder right)</a>
<a class="sourceLine" id="cb13-34" data-line-number="34"></a>
<a class="sourceLine" id="cb13-35" data-line-number="35"><span class="ot">postorder ::</span> <span class="dt">BinaryTree</span> a <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb13-36" data-line-number="36">postorder <span class="dt">Leaf</span> <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb13-37" data-line-number="37">postorder (<span class="dt">Node</span> left a right) <span class="fu">=</span> (postorder left) <span class="fu">++</span> (postorder right) <span class="fu">++</span> [a]</a>
<a class="sourceLine" id="cb13-38" data-line-number="38"></a>
<a class="sourceLine" id="cb13-39" data-line-number="39"><span class="ot">testTree ::</span> <span class="dt">BinaryTree</span> <span class="dt">Integer</span></a>
<a class="sourceLine" id="cb13-40" data-line-number="40">testTree <span class="fu">=</span> <span class="dt">Node</span> (<span class="dt">Node</span> <span class="dt">Leaf</span> <span class="dv">1</span> <span class="dt">Leaf</span>) <span class="dv">2</span> (<span class="dt">Node</span> <span class="dt">Leaf</span> <span class="dv">3</span> <span class="dt">Leaf</span>)</a>
<a class="sourceLine" id="cb13-41" data-line-number="41"></a>
<a class="sourceLine" id="cb13-42" data-line-number="42">testPreorder <span class="fu">=</span> preorder testTree <span class="fu">==</span> [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>]</a>
<a class="sourceLine" id="cb13-43" data-line-number="43"></a>
<a class="sourceLine" id="cb13-44" data-line-number="44">testInorder <span class="fu">=</span> inorder testTree <span class="fu">==</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</a>
<a class="sourceLine" id="cb13-45" data-line-number="45"></a>
<a class="sourceLine" id="cb13-46" data-line-number="46">testPostorder <span class="fu">=</span> postorder testTree <span class="fu">==</span> [<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>]</a>
<a class="sourceLine" id="cb13-47" data-line-number="47"></a>
<a class="sourceLine" id="cb13-48" data-line-number="48"><span class="ot">foldTree ::</span> (a <span class="ot">-&gt;</span> b <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> b <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> a <span class="ot">-&gt;</span> b</a>
<a class="sourceLine" id="cb13-49" data-line-number="49">foldTree f ac <span class="dt">Leaf</span> <span class="fu">=</span> ac</a>
<a class="sourceLine" id="cb13-50" data-line-number="50">foldTree f ac (<span class="dt">Node</span> left v right) <span class="fu">=</span> foldTree f (foldTree f (f v ac) left) right</a>
<a class="sourceLine" id="cb13-51" data-line-number="51"></a>
<a class="sourceLine" id="cb13-52" data-line-number="52"><span class="ot">foldTree' ::</span> (a <span class="ot">-&gt;</span> b <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> b <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> a <span class="ot">-&gt;</span> b</a>
<a class="sourceLine" id="cb13-53" data-line-number="53">foldTree' f ac bt <span class="fu">=</span> foldr f ac (inorder bt)</a>
<a class="sourceLine" id="cb13-54" data-line-number="54"></a>
<a class="sourceLine" id="cb13-55" data-line-number="55"><span class="ot">mapTree' ::</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> a <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> b</a>
<a class="sourceLine" id="cb13-56" data-line-number="56">mapTree' f bt <span class="fu">=</span> foldTree g <span class="dt">Leaf</span> bt</a>
<a class="sourceLine" id="cb13-57" data-line-number="57">  <span class="kw">where</span> g v acc <span class="fu">=</span> <span class="dt">Node</span> acc (f v) <span class="dt">Leaf</span></a>
<a class="sourceLine" id="cb13-58" data-line-number="58"></a>
<a class="sourceLine" id="cb13-59" data-line-number="59"><span class="ot">mapTree2 ::</span> <span class="dt">Ord</span> b <span class="ot">=&gt;</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> a <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> b</a>
<a class="sourceLine" id="cb13-60" data-line-number="60">mapTree2 f bt <span class="fu">=</span> foldTree g <span class="dt">Leaf</span> bt</a>
<a class="sourceLine" id="cb13-61" data-line-number="61">  <span class="kw">where</span> g v acc <span class="fu">=</span> insert' (f v) acc</a>
<a class="sourceLine" id="cb13-62" data-line-number="62"></a>
<a class="sourceLine" id="cb13-63" data-line-number="63">testTree2 <span class="fu">=</span> <span class="dt">Node</span> (<span class="dt">Node</span> (<span class="dt">Leaf</span>) <span class="dv">2</span> (<span class="dt">Node</span> <span class="dt">Leaf</span> <span class="dv">5</span> <span class="dt">Leaf</span>)) <span class="dv">1</span></a>
<a class="sourceLine" id="cb13-64" data-line-number="64">                 (<span class="dt">Node</span> (<span class="dt">Node</span> <span class="dt">Leaf</span> <span class="dv">6</span> <span class="dt">Leaf</span>) <span class="dv">3</span> (<span class="dt">Node</span> <span class="dt">Leaf</span> <span class="dv">7</span> <span class="dt">Leaf</span>))</a>
<a class="sourceLine" id="cb13-65" data-line-number="65"></a>
<a class="sourceLine" id="cb13-66" data-line-number="66"></a>
<a class="sourceLine" id="cb13-67" data-line-number="67"><span class="ot">foldTree1 ::</span> (a <span class="ot">-&gt;</span> b <span class="ot">-&gt;</span> b <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> b <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> a <span class="ot">-&gt;</span> b</a>
<a class="sourceLine" id="cb13-68" data-line-number="68">foldTree1 f a <span class="dt">Leaf</span> <span class="fu">=</span> a</a>
<a class="sourceLine" id="cb13-69" data-line-number="69">foldTree1 f a (<span class="dt">Node</span> left v right) <span class="fu">=</span></a>
<a class="sourceLine" id="cb13-70" data-line-number="70">  f v (foldTree1 f a left) (foldTree1 f a right)</a>
<a class="sourceLine" id="cb13-71" data-line-number="71"></a>
<a class="sourceLine" id="cb13-72" data-line-number="72"><span class="ot">mapTree1 ::</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> a <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> b</a>
<a class="sourceLine" id="cb13-73" data-line-number="73">mapTree1 f bt <span class="fu">=</span> foldTree1 g <span class="dt">Leaf</span> bt <span class="kw">where</span></a>
<a class="sourceLine" id="cb13-74" data-line-number="74">  g a left right <span class="fu">=</span> <span class="dt">Node</span> left (f a) right</a></code></pre></div>
<h2 id="chapter-exercises">11.18 Chapter Exercises</h2>
<h3 id="multiple-choice">Multiple Choice</h3>
<ol type="1">
<li>a</li>
<li>c</li>
<li>b</li>
<li>c</li>
</ol>
<h3 id="ciphers">Ciphers</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co">--11/Vignere.hs</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">module</span> <span class="dt">Vignere</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Data.Char</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="ot">vignere ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7">vignere key cleartext <span class="fu">=</span> map caeserHelper <span class="fu">$</span> zip key' clr' <span class="kw">where</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8">    pre <span class="fu">=</span> (map toLower <span class="fu">.</span> filter isAlpha)</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">    clr' <span class="fu">=</span> (pre cleartext)</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">    key' <span class="fu">=</span> take (length clr') <span class="fu">$</span> cycle (pre key)</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">    caeserHelper (a, b) <span class="fu">=</span> chr ((ord a <span class="fu">+</span> ord b <span class="fu">-</span> <span class="dv">2</span><span class="fu">*</span>ord <span class="ch">'a'</span>) <span class="ot">`mod`</span> <span class="dv">26</span> <span class="fu">+</span> ord <span class="ch">'a'</span>)</a>
<a class="sourceLine" id="cb14-12" data-line-number="12"></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="ot">unVignere ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14">unVignere key ciphertext <span class="fu">=</span> map caeserHelper <span class="fu">$</span> zip key' ciphertext <span class="kw">where</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15">    pre <span class="fu">=</span> (map toLower <span class="fu">.</span> filter isAlpha)</a>
<a class="sourceLine" id="cb14-16" data-line-number="16">    key' <span class="fu">=</span> take (length ciphertext) <span class="fu">$</span> cycle (pre key)</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">    caeserHelper (a, b) <span class="fu">=</span> chr ((ord b <span class="fu">-</span> ord a) <span class="ot">`mod`</span> <span class="dv">26</span> <span class="fu">+</span> ord <span class="ch">'a'</span>)</a></code></pre></div>
<h3 id="as-patterns">As-patterns</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co">--11/AsPatterns.hs</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">module</span> <span class="dt">AsPatterns</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Data.Char</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="ot">doubleUp ::</span> [a] <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">doubleUp [] <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">doubleUp xs<span class="fu">@</span>(x<span class="fu">:</span>_) <span class="fu">=</span> x <span class="fu">:</span> xs</a>
<a class="sourceLine" id="cb15-9" data-line-number="9"></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">-- 1</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="ot">isSubsequenceOf ::</span> (<span class="dt">Eq</span> a) <span class="ot">=&gt;</span> [a] <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12">isSubsequenceOf [] _ <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13">isSubsequenceOf _ [] <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14">isSubsequenceOf (x<span class="fu">:</span>xs) b <span class="fu">=</span> elem x b <span class="fu">&amp;&amp;</span> isSubsequenceOf xs b</a>
<a class="sourceLine" id="cb15-15" data-line-number="15"></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="co">-- 2</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="ot">capWords ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> [(<span class="dt">String</span>, <span class="dt">String</span>)]</a>
<a class="sourceLine" id="cb15-18" data-line-number="18">capWords str <span class="fu">=</span> map cap <span class="fu">$</span> words str <span class="kw">where</span></a>
<a class="sourceLine" id="cb15-19" data-line-number="19">  cap a<span class="fu">@</span>(x<span class="fu">:</span>xs) <span class="fu">=</span> (,) a <span class="fu">$</span> (toUpper x)<span class="fu">:</span>xs</a></code></pre></div>
<h3 id="language-exercises">Language exercises</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co">--11/LanguageExercises.hs</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw">module</span> <span class="dt">LanguageExercises</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Data.Char</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="ot">capWord ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7">capWord a<span class="fu">@</span>(x<span class="fu">:</span>xs) <span class="fu">=</span> <span class="kw">if</span> x <span class="fu">&gt;=</span> <span class="ch">'a'</span> <span class="fu">&amp;&amp;</span> x <span class="fu">&lt;=</span> <span class="ch">'z'</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8">                          <span class="kw">then</span> chr((ord x) <span class="fu">-</span> <span class="dv">32</span>)<span class="fu">:</span>xs</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">                          <span class="kw">else</span> a</a>
<a class="sourceLine" id="cb16-10" data-line-number="10"></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="ot">capParagraph ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12">capParagraph p <span class="fu">=</span> init <span class="fu">$</span> concat <span class="fu">$</span> map (<span class="fu">++</span> <span class="st">&quot; &quot;</span>) <span class="fu">$</span> capp <span class="fu">$</span> words p <span class="kw">where</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13">  capp  [] <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb16-14" data-line-number="14">  capp  (x<span class="fu">:</span>xs) <span class="fu">=</span> <span class="kw">if</span> (last x) <span class="fu">==</span> <span class="ch">'.'</span> <span class="kw">then</span> x<span class="fu">:</span>(capp' xs) <span class="kw">else</span> x<span class="fu">:</span>(capp xs)</a>
<a class="sourceLine" id="cb16-15" data-line-number="15">  capp' [] <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb16-16" data-line-number="16">  capp' (x<span class="fu">:</span>xs) <span class="fu">=</span> <span class="kw">if</span> (last x) <span class="fu">==</span> <span class="ch">'.'</span> <span class="kw">then</span> (capWord x)<span class="fu">:</span>(capp' xs) <span class="kw">else</span> x<span class="fu">:</span>(capp xs)</a></code></pre></div>
<h3 id="phone-exercise">Phone exercise</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co">--11/Phone.hs</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw">module</span> <span class="dt">Phone</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Data.List</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="kw">import</span> <span class="dt">Data.Char</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="kw">data</span> <span class="dt">Phone</span> <span class="fu">=</span> <span class="dt">Phone</span> {<span class="ot">buttons ::</span> [<span class="dt">Button</span>]} <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb17-8" data-line-number="8"></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="kw">data</span> <span class="dt">Mode</span> <span class="fu">=</span> <span class="dt">Shift</span> <span class="fu">|</span> <span class="dt">None</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="kw">data</span> <span class="dt">Button</span> <span class="fu">=</span> <span class="dt">Button</span> {<span class="ot">key ::</span> <span class="dt">Key</span>,<span class="ot"> output ::</span> <span class="dt">String</span>} <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="kw">type</span> <span class="dt">Key</span> <span class="fu">=</span> <span class="dt">Char</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="kw">type</span> <span class="dt">Press</span> <span class="fu">=</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"></a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="ot">daPhone ::</span> <span class="dt">Phone</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15">daPhone <span class="fu">=</span> <span class="dt">Phone</span></a>
<a class="sourceLine" id="cb17-16" data-line-number="16">          [ <span class="dt">Button</span> <span class="ch">'1'</span> <span class="st">&quot;1&quot;</span>    , <span class="dt">Button</span> <span class="ch">'2'</span> <span class="st">&quot;ABC2&quot;</span>, <span class="dt">Button</span> <span class="ch">'3'</span> <span class="st">&quot;DEF3&quot;</span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17">          , <span class="dt">Button</span> <span class="ch">'4'</span> <span class="st">&quot;GHI4&quot;</span> , <span class="dt">Button</span> <span class="ch">'5'</span> <span class="st">&quot;JKL5&quot;</span>, <span class="dt">Button</span> <span class="ch">'6'</span> <span class="st">&quot;MNO6&quot;</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18">          , <span class="dt">Button</span> <span class="ch">'7'</span> <span class="st">&quot;PQRS7&quot;</span>, <span class="dt">Button</span> <span class="ch">'8'</span> <span class="st">&quot;TUV8&quot;</span>, <span class="dt">Button</span> <span class="ch">'9'</span> <span class="st">&quot;WXYZ9&quot;</span></a>
<a class="sourceLine" id="cb17-19" data-line-number="19">          , <span class="dt">Button</span> <span class="ch">'*'</span> <span class="st">&quot;^*&quot;</span>   , <span class="dt">Button</span> <span class="ch">'0'</span> <span class="st">&quot; 0&quot;</span>  , <span class="dt">Button</span> <span class="ch">'#'</span> <span class="st">&quot;.,#&quot;</span></a>
<a class="sourceLine" id="cb17-20" data-line-number="20">          ]</a>
<a class="sourceLine" id="cb17-21" data-line-number="21"></a>
<a class="sourceLine" id="cb17-22" data-line-number="22">convo <span class="fu">=</span> [<span class="st">&quot;Wanna play 20 questions&quot;</span>,</a>
<a class="sourceLine" id="cb17-23" data-line-number="23">         <span class="st">&quot;Ya&quot;</span>,</a>
<a class="sourceLine" id="cb17-24" data-line-number="24">         <span class="st">&quot;U 1st haha&quot;</span>,</a>
<a class="sourceLine" id="cb17-25" data-line-number="25">         <span class="st">&quot;Lol ok. Have u ever tated alcohol lol&quot;</span>,</a>
<a class="sourceLine" id="cb17-26" data-line-number="26">         <span class="st">&quot;Lol ya&quot;</span>,</a>
<a class="sourceLine" id="cb17-27" data-line-number="27">         <span class="st">&quot;Wow ur cool haha. Ur turn&quot;</span>,</a>
<a class="sourceLine" id="cb17-28" data-line-number="28">         <span class="st">&quot;Ok. Do u think I am pretty lol&quot;</span>,</a>
<a class="sourceLine" id="cb17-29" data-line-number="29">         <span class="st">&quot;lol ya&quot;</span>,</a>
<a class="sourceLine" id="cb17-30" data-line-number="30">         <span class="st">&quot;Haha thanks just makin sure rofl ur turn&quot;</span>]</a>
<a class="sourceLine" id="cb17-31" data-line-number="31"></a>
<a class="sourceLine" id="cb17-32" data-line-number="32"><span class="ot">keyMap ::</span> <span class="dt">Phone</span> <span class="ot">-&gt;</span> (<span class="dt">Key</span>, <span class="dt">Press</span>) <span class="ot">-&gt;</span> <span class="dt">Mode</span> <span class="ot">-&gt;</span> <span class="dt">Char</span></a>
<a class="sourceLine" id="cb17-33" data-line-number="33">keyMap phone (k, p) mode <span class="fu">=</span></a>
<a class="sourceLine" id="cb17-34" data-line-number="34">  <span class="kw">if</span> mode <span class="fu">==</span> <span class="dt">Shift</span> <span class="kw">then</span> out <span class="kw">else</span> toLower out <span class="kw">where</span></a>
<a class="sourceLine" id="cb17-35" data-line-number="35">    out <span class="fu">=</span> outCycle <span class="fu">!!</span> ((p <span class="fu">-</span> <span class="dv">1</span>) <span class="ot">`mod`</span> (length outCycle))</a>
<a class="sourceLine" id="cb17-36" data-line-number="36">    outCycle <span class="fu">=</span> unpack <span class="fu">$</span> lookup k <span class="fu">$</span> zip (map key pb) (map output pb)</a>
<a class="sourceLine" id="cb17-37" data-line-number="37">    pb <span class="fu">=</span> (buttons phone)</a>
<a class="sourceLine" id="cb17-38" data-line-number="38">    unpack (<span class="dt">Just</span> a) <span class="fu">=</span> a</a>
<a class="sourceLine" id="cb17-39" data-line-number="39"></a>
<a class="sourceLine" id="cb17-40" data-line-number="40"><span class="ot">textOut ::</span> <span class="dt">Phone</span> <span class="ot">-&gt;</span> [(<span class="dt">Key</span>, <span class="dt">Press</span>)] <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb17-41" data-line-number="41">textOut phone kps <span class="fu">=</span> go phone kps <span class="dt">None</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb17-42" data-line-number="42">  go phone [] _ <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb17-43" data-line-number="43">  go phone ((<span class="ch">'*'</span>, <span class="dv">1</span>)<span class="fu">:</span>kps) <span class="dt">None</span> <span class="fu">=</span> go phone kps <span class="dt">Shift</span></a>
<a class="sourceLine" id="cb17-44" data-line-number="44">  go phone ((<span class="ch">'*'</span>, <span class="dv">1</span>)<span class="fu">:</span>kps) <span class="dt">Shift</span> <span class="fu">=</span> go phone kps <span class="dt">None</span></a>
<a class="sourceLine" id="cb17-45" data-line-number="45">  go phone (kp<span class="fu">:</span>kps) m <span class="fu">=</span>  ((keyMap phone) (shift kp) m) <span class="fu">:</span> go phone kps <span class="dt">None</span></a>
<a class="sourceLine" id="cb17-46" data-line-number="46">  shift (k, p) <span class="fu">=</span> <span class="kw">if</span> k <span class="fu">==</span> <span class="ch">'*'</span> <span class="kw">then</span> (k, p <span class="fu">-</span> <span class="dv">1</span>) <span class="kw">else</span> (k, p)</a>
<a class="sourceLine" id="cb17-47" data-line-number="47"></a>
<a class="sourceLine" id="cb17-48" data-line-number="48"><span class="ot">invButton ::</span> <span class="dt">Button</span> <span class="ot">-&gt;</span> [(<span class="dt">Char</span>, (<span class="dt">Key</span>, <span class="dt">Press</span>))]</a>
<a class="sourceLine" id="cb17-49" data-line-number="49">invButton b <span class="fu">=</span> go ((key b), (output b)) <span class="dv">1</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb17-50" data-line-number="50">  go (k, []) _ <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb17-51" data-line-number="51">  go (k, (c<span class="fu">:</span>cs)) n <span class="fu">=</span> (c, (k, n)) <span class="fu">:</span> go (k, cs) (n <span class="fu">+</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-52" data-line-number="52"></a>
<a class="sourceLine" id="cb17-53" data-line-number="53"><span class="ot">invKeyMap ::</span> <span class="dt">Phone</span> <span class="ot">-&gt;</span> <span class="dt">Char</span> <span class="ot">-&gt;</span> <span class="dt">Maybe</span> (<span class="dt">Key</span>, <span class="dt">Press</span>)</a>
<a class="sourceLine" id="cb17-54" data-line-number="54">invKeyMap phone c <span class="fu">=</span> lookup c <span class="fu">$</span> concatMap invButton <span class="fu">$</span> buttons daPhone</a>
<a class="sourceLine" id="cb17-55" data-line-number="55"></a>
<a class="sourceLine" id="cb17-56" data-line-number="56"><span class="ot">keyPressIn ::</span> <span class="dt">Phone</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> [<span class="dt">Maybe</span> (<span class="dt">Key</span>, <span class="dt">Press</span>)]</a>
<a class="sourceLine" id="cb17-57" data-line-number="57">keyPressIn phone [] <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb17-58" data-line-number="58">keyPressIn phone (x<span class="fu">:</span>xs) <span class="fu">=</span> <span class="kw">if</span> isUpper x <span class="kw">then</span> up <span class="kw">else</span> lo <span class="kw">where</span></a>
<a class="sourceLine" id="cb17-59" data-line-number="59">  up <span class="fu">=</span> (<span class="dt">Just</span> (<span class="ch">'*'</span>, <span class="dv">1</span>))<span class="fu">:</span>(invKeyMap phone x)<span class="fu">:</span>(keyPressIn phone xs)</a>
<a class="sourceLine" id="cb17-60" data-line-number="60">  lo <span class="fu">=</span> (invKeyMap phone (toUpper x))<span class="fu">:</span>(keyPressIn phone xs)</a>
<a class="sourceLine" id="cb17-61" data-line-number="61"></a>
<a class="sourceLine" id="cb17-62" data-line-number="62"><span class="ot">fingerTaps ::</span> [<span class="dt">Maybe</span> (<span class="dt">Key</span>, <span class="dt">Press</span>)] <span class="ot">-&gt;</span> <span class="dt">Press</span></a>
<a class="sourceLine" id="cb17-63" data-line-number="63">fingerTaps a <span class="fu">=</span> go a <span class="dv">0</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb17-64" data-line-number="64">  go [] n <span class="fu">=</span> n</a>
<a class="sourceLine" id="cb17-65" data-line-number="65">  go ((<span class="dt">Nothing</span>)<span class="fu">:</span>xs) n <span class="fu">=</span> go xs n</a>
<a class="sourceLine" id="cb17-66" data-line-number="66">  go ((<span class="dt">Just</span> (k, p))<span class="fu">:</span>xs) n <span class="fu">=</span> go xs (p <span class="fu">+</span> n)</a>
<a class="sourceLine" id="cb17-67" data-line-number="67"></a>
<a class="sourceLine" id="cb17-68" data-line-number="68"><span class="ot">mostPopularLetter ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Char</span></a>
<a class="sourceLine" id="cb17-69" data-line-number="69">mostPopularLetter str <span class="fu">=</span> head <span class="fu">$</span> maximumBy cmp <span class="fu">$</span> group str <span class="kw">where</span></a>
<a class="sourceLine" id="cb17-70" data-line-number="70">  cmp a b <span class="fu">=</span> compare (length a) (length b)</a>
<a class="sourceLine" id="cb17-71" data-line-number="71"></a>
<a class="sourceLine" id="cb17-72" data-line-number="72"><span class="ot">costOfMostPopularLetter ::</span> <span class="dt">Phone</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Press</span></a>
<a class="sourceLine" id="cb17-73" data-line-number="73">costOfMostPopularLetter phone str <span class="fu">=</span> fingerTaps <span class="fu">$</span> keyPressIn phone [a] <span class="kw">where</span></a>
<a class="sourceLine" id="cb17-74" data-line-number="74">  a <span class="fu">=</span> mostPopularLetter str</a>
<a class="sourceLine" id="cb17-75" data-line-number="75"></a>
<a class="sourceLine" id="cb17-76" data-line-number="76"><span class="ot">coolestLtr ::</span> [<span class="dt">String</span>] <span class="ot">-&gt;</span> <span class="dt">Char</span></a>
<a class="sourceLine" id="cb17-77" data-line-number="77">coolestLtr msgs <span class="fu">=</span> mostPopularLetter <span class="fu">$</span> map mostPopularLetter msgs</a>
<a class="sourceLine" id="cb17-78" data-line-number="78"></a>
<a class="sourceLine" id="cb17-79" data-line-number="79"><span class="ot">coolestWord ::</span> [<span class="dt">String</span>] <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb17-80" data-line-number="80">coolestWord msgs <span class="fu">=</span> head <span class="fu">$</span> maximumBy cmp <span class="fu">$</span> group <span class="fu">$</span> concatMap words msgs <span class="kw">where</span></a>
<a class="sourceLine" id="cb17-81" data-line-number="81">  cmp a b <span class="fu">=</span> compare (length a) (length b)</a></code></pre></div>
<p>[TODO: I’m looking back on this code several months after writing it. It’s awkward, but I’ll leave it as is for now, since it’s an okay example of solving the problem with only the tools covered in the book thus far. I think I should do an example of how this project gets a lot easier when you can use things like the State monad.]</p>
<h3 id="huttons-razor">Hutton’s Razor</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co">--11/Hutton.hs</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw">module</span> <span class="dt">Hutton</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">--1</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="kw">data</span> <span class="dt">Expr</span> <span class="fu">=</span> <span class="dt">Lit</span> <span class="dt">Integer</span> <span class="fu">|</span> <span class="dt">Add</span> <span class="dt">Expr</span> <span class="dt">Expr</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="ot">eval ::</span> <span class="dt">Expr</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8">eval (<span class="dt">Lit</span> n) <span class="fu">=</span> n</a>
<a class="sourceLine" id="cb18-9" data-line-number="9">eval (<span class="dt">Add</span> a b) <span class="fu">=</span> (<span class="fu">+</span>) (eval a) (eval b)</a>
<a class="sourceLine" id="cb18-10" data-line-number="10"></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">-- 2</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="ot">printExpr ::</span> <span class="dt">Expr</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14">printExpr (<span class="dt">Lit</span> n) <span class="fu">=</span> show n</a>
<a class="sourceLine" id="cb18-15" data-line-number="15">printExpr (<span class="dt">Add</span> a b) <span class="fu">=</span> (printExpr a) <span class="fu">++</span> <span class="st">&quot; + &quot;</span> <span class="fu">++</span> (printExpr b)</a></code></pre></div>
<hr />

        </div>
        <div id="footer">
          <p>&copy; <script>document.write(new Date().getFullYear());</script>
             John Chandler Burnham.
            Generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>
          </p>
        </div>
    </body>
</html>
