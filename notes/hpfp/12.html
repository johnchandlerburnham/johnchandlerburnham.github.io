<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>John Chandler Burnham - Notes (HPFP 12/31): Signaling Adversity</title>
        <link rel="stylesheet" type="text/css" href="../../css/default.css" />
    </head>
    <body>
        <div id="header">
            <div id="navigation">
                <a href="../../">jcb</a>
                <a href="../../posts.html">posts</a>
                <a href="../../projects.html">projects</a>
                <a href="https://github.com/johnchandlerburnham">github</a>
                <a href="https://twitter.com/John_C_Burnham">twitter</a>
            </div>
        </div>
        <div id="content">
            <h1>Notes (HPFP 12/31): Signaling Adversity</h1>
          <div id="title" class="info">
    Posted on November  1, 2017
    
        by jcb
    
<hr>
</div>

<h1 id="signaling-adversity">12 Signaling adversity</h1>
<h2 id="chapter-exercises">12.5 Chapter Exercises</h2>
<h3 id="determine-the-kinds">Determine the kinds</h3>
<ol type="1">
<li><code>*</code></li>
<li><code>a</code> is <code>*</code>, <code>f</code> is <code>* -&gt; *</code></li>
</ol>
<h3 id="string-processing">String processing</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">--12/StringProcessing.hs</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">module</span> <span class="dt">StringProcessing</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="ot">notThe ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Maybe</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">notThe str <span class="fu">=</span> <span class="kw">if</span> str <span class="fu">==</span> <span class="st">&quot;the&quot;</span> <span class="kw">then</span> <span class="dt">Nothing</span> <span class="kw">else</span> <span class="dt">Just</span> str</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="ot">wurdz ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> [<span class="dt">String</span>]</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">wurdz str <span class="fu">=</span> (fst a)<span class="fu">:</span>(<span class="kw">if</span> (snd a) <span class="fu">==</span> [] <span class="kw">then</span> [] <span class="kw">else</span> (wurdz <span class="fu">$</span> tail <span class="fu">$</span> snd a))</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  <span class="kw">where</span> a <span class="fu">=</span> break ((<span class="fu">==</span>) <span class="ch">' '</span>) str</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="ot">wurdzMap ::</span>  (<span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">wurdzMap f str <span class="fu">=</span> (f (fst a)) <span class="fu">++</span> (<span class="kw">if</span> (snd a) <span class="fu">==</span> []</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">                                 <span class="kw">then</span> <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">                                 <span class="kw">else</span> <span class="st">&quot; &quot;</span> <span class="fu">++</span> (wurdzMap f <span class="fu">$</span> tail <span class="fu">$</span> snd a))</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">  <span class="kw">where</span> a <span class="fu">=</span> break ((<span class="fu">==</span>) <span class="ch">' '</span>) str</a>
<a class="sourceLine" id="cb1-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="ot">replaceThe ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18">replaceThe str <span class="fu">=</span> init <span class="fu">$</span> go (words str) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">  go [] <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">  go (x<span class="fu">:</span>xs) <span class="fu">=</span> (<span class="kw">if</span> notThe x <span class="fu">==</span> <span class="dt">Nothing</span> <span class="kw">then</span> <span class="st">&quot;a&quot;</span> <span class="kw">else</span> u <span class="fu">$</span> notThe x)</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">                <span class="fu">++</span> <span class="st">&quot; &quot;</span> <span class="fu">++</span> (go xs)</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">  u (<span class="dt">Just</span> a) <span class="fu">=</span> a</a>
<a class="sourceLine" id="cb1-23" data-line-number="23"></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="ot">replaceThe' ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25">replaceThe' str <span class="fu">=</span> init <span class="fu">$</span> concatMap (g <span class="fu">.</span> f) <span class="fu">$</span> wurdz str <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26">  g x <span class="fu">=</span> ((<span class="fu">++</span>) x <span class="st">&quot; &quot;</span>)</a>
<a class="sourceLine" id="cb1-27" data-line-number="27">  f x <span class="fu">=</span> (<span class="kw">if</span> notThe x <span class="fu">==</span> <span class="dt">Nothing</span> <span class="kw">then</span> <span class="st">&quot;a&quot;</span> <span class="kw">else</span> u <span class="fu">$</span> notThe x)</a>
<a class="sourceLine" id="cb1-28" data-line-number="28">  u (<span class="dt">Just</span> a) <span class="fu">=</span> a</a>
<a class="sourceLine" id="cb1-29" data-line-number="29"></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="ot">replaceThe2 ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31">replaceThe2 str <span class="fu">=</span> wurdzMap (f <span class="fu">.</span>notThe) str <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32">  f (<span class="dt">Nothing</span>) <span class="fu">=</span> <span class="st">&quot;a&quot;</span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33">  f (<span class="dt">Just</span> a) <span class="fu">=</span> a</a>
<a class="sourceLine" id="cb1-34" data-line-number="34"></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co">-- 2</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="ot">isVowel ::</span> <span class="dt">Char</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38">isVowel c <span class="fu">=</span> (elem c <span class="st">&quot;aeiouAEIOU&quot;</span>)</a>
<a class="sourceLine" id="cb1-39" data-line-number="39"></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="ot">countTheBeforeVowel ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41">countTheBeforeVowel str <span class="fu">=</span> go (words str) <span class="dv">0</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-42" data-line-number="42">  go [] n <span class="fu">=</span> n</a>
<a class="sourceLine" id="cb1-43" data-line-number="43">  go [x] n <span class="fu">=</span> n</a>
<a class="sourceLine" id="cb1-44" data-line-number="44">  go (x<span class="fu">:</span>(c<span class="fu">:</span>cs)<span class="fu">:</span>xss) n <span class="fu">=</span> <span class="kw">if</span> (x <span class="fu">==</span> <span class="st">&quot;the&quot;</span> <span class="fu">&amp;&amp;</span> (isVowel c))</a>
<a class="sourceLine" id="cb1-45" data-line-number="45">                       <span class="kw">then</span> go xss (n <span class="fu">+</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-46" data-line-number="46">                       <span class="kw">else</span> go xss n</a>
<a class="sourceLine" id="cb1-47" data-line-number="47"></a>
<a class="sourceLine" id="cb1-48" data-line-number="48"><span class="ot">countVowels ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span></a>
<a class="sourceLine" id="cb1-49" data-line-number="49">countVowels str <span class="fu">=</span> foldr f <span class="dv">0</span> str <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-50" data-line-number="50">  f x y <span class="fu">=</span> <span class="kw">if</span> isVowel x <span class="kw">then</span> y <span class="fu">+</span> <span class="dv">1</span> <span class="kw">else</span> y</a>
<a class="sourceLine" id="cb1-51" data-line-number="51"></a>
<a class="sourceLine" id="cb1-52" data-line-number="52"><span class="ot">countConsonants ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span></a>
<a class="sourceLine" id="cb1-53" data-line-number="53">countConsonants str <span class="fu">=</span> foldr f <span class="dv">0</span> str <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-54" data-line-number="54">  f x y <span class="fu">=</span> <span class="kw">if</span> not <span class="fu">$</span> isVowel x <span class="kw">then</span> y <span class="fu">+</span> <span class="dv">1</span> <span class="kw">else</span> y</a>
<a class="sourceLine" id="cb1-55" data-line-number="55"></a>
<a class="sourceLine" id="cb1-56" data-line-number="56"><span class="co">-- Validate the word</span></a>
<a class="sourceLine" id="cb1-57" data-line-number="57"></a>
<a class="sourceLine" id="cb1-58" data-line-number="58"><span class="kw">newtype</span> <span class="dt">Word'</span> <span class="fu">=</span> <span class="dt">Word'</span> <span class="dt">String</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb1-59" data-line-number="59"></a>
<a class="sourceLine" id="cb1-60" data-line-number="60">vowels <span class="fu">=</span> <span class="st">&quot;aeiou&quot;</span></a>
<a class="sourceLine" id="cb1-61" data-line-number="61"></a>
<a class="sourceLine" id="cb1-62" data-line-number="62"><span class="ot">mkWord ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Maybe</span> <span class="dt">Word'</span></a>
<a class="sourceLine" id="cb1-63" data-line-number="63">mkWord str <span class="fu">=</span> <span class="kw">if</span> countConsonants str <span class="fu">&gt;=</span> countVowels str</a>
<a class="sourceLine" id="cb1-64" data-line-number="64">             <span class="kw">then</span> (<span class="dt">Just</span> (<span class="dt">Word'</span> str)) <span class="kw">else</span> <span class="dt">Nothing</span></a></code></pre></div>
<h3 id="validate-the-word">Validate the word</h3>
<p>see `12/StringProcessing.hs,</p>
<h3 id="its-only-natural">It’s only Natural</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">--12/Natural.hs</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">module</span> <span class="dt">Natural</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">data</span> <span class="dt">Nat</span> <span class="fu">=</span> <span class="dt">Zero</span> <span class="fu">|</span> <span class="dt">Succ</span> <span class="dt">Nat</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="ot">natToInteger ::</span> <span class="dt">Nat</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">natToInteger nat <span class="fu">=</span> go nat <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">    go <span class="dt">Zero</span> n <span class="fu">=</span> n</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">    go (<span class="dt">Succ</span> a) n <span class="fu">=</span> go a (n <span class="fu">+</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="ot">integerToNat ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Maybe</span> <span class="dt">Nat</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">integerToNat n</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">  <span class="fu">|</span> n <span class="fu">&lt;</span> <span class="dv">0</span> <span class="fu">=</span> <span class="dt">Nothing</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15">  <span class="fu">|</span> otherwise <span class="fu">=</span> (<span class="dt">Just</span> <span class="fu">$</span> go n <span class="dt">Zero</span>)</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17">    go <span class="dv">0</span> nat <span class="fu">=</span> nat</a>
<a class="sourceLine" id="cb2-18" data-line-number="18">    go n nat <span class="fu">=</span> go (n <span class="fu">-</span> <span class="dv">1</span>) (<span class="dt">Succ</span> nat)</a></code></pre></div>
<h3 id="small-library-for-maybe">Small library for Maybe</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">--12/MaybeLib.hs</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">module</span> <span class="dt">MaybeLib</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">-- 1</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="ot">isJust ::</span> <span class="dt">Maybe</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">isJust <span class="dt">Nothing</span> <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">isJust (<span class="dt">Just</span> a) <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="ot">isNothing ::</span> <span class="dt">Maybe</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">isNothing <span class="fu">=</span> not <span class="fu">.</span> isJust</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">-- 2</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="ot">mayybee ::</span> b <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> <span class="dt">Maybe</span> a <span class="ot">-&gt;</span> b</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">mayybee b f (<span class="dt">Just</span> a) <span class="fu">=</span> (f a)</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">mayybee b f <span class="dt">Nothing</span> <span class="fu">=</span> b</a>
<a class="sourceLine" id="cb3-16" data-line-number="16"></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">-- 3</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="ot">fromMaybe ::</span> a <span class="ot">-&gt;</span> <span class="dt">Maybe</span> a <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb3-19" data-line-number="19">fromMaybe a m <span class="fu">=</span> mayybee a id m</a>
<a class="sourceLine" id="cb3-20" data-line-number="20"></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">-- 4</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="ot">listToMaybe ::</span> [a] <span class="ot">-&gt;</span> <span class="dt">Maybe</span> a</a>
<a class="sourceLine" id="cb3-23" data-line-number="23">listToMaybe [] <span class="fu">=</span> <span class="dt">Nothing</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24">listToMaybe (x<span class="fu">:</span>xs) <span class="fu">=</span> (<span class="dt">Just</span> x)</a>
<a class="sourceLine" id="cb3-25" data-line-number="25"></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="ot">maybeToList ::</span> <span class="dt">Maybe</span> a <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb3-27" data-line-number="27">maybeToList <span class="dt">Nothing</span> <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb3-28" data-line-number="28">maybeToList (<span class="dt">Just</span> a) <span class="fu">=</span> [a]</a>
<a class="sourceLine" id="cb3-29" data-line-number="29"></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">-- 5</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="ot">catMaybes ::</span> [<span class="dt">Maybe</span> a] <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb3-32" data-line-number="32">catMaybes [] <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb3-33" data-line-number="33">catMaybes ((<span class="dt">Just</span> a)<span class="fu">:</span>xs) <span class="fu">=</span> a <span class="fu">:</span> (catMaybes xs)</a>
<a class="sourceLine" id="cb3-34" data-line-number="34">catMaybes (<span class="dt">Nothing</span><span class="fu">:</span>xs) <span class="fu">=</span> catMaybes xs</a>
<a class="sourceLine" id="cb3-35" data-line-number="35"></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">-- 6</span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="ot">flipMaybe ::</span> [<span class="dt">Maybe</span> a] <span class="ot">-&gt;</span> <span class="dt">Maybe</span> [a]</a>
<a class="sourceLine" id="cb3-38" data-line-number="38">flipMaybe ms <span class="fu">=</span> go ms [] <span class="kw">where</span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39">  go [] acc <span class="fu">=</span> <span class="dt">Just</span> acc</a>
<a class="sourceLine" id="cb3-40" data-line-number="40">  go ((<span class="dt">Just</span> x)<span class="fu">:</span>xs) acc <span class="fu">=</span> go xs (x<span class="fu">:</span>acc)</a>
<a class="sourceLine" id="cb3-41" data-line-number="41">  go (<span class="dt">Nothing</span><span class="fu">:</span>xs) _ <span class="fu">=</span> <span class="dt">Nothing</span></a></code></pre></div>
<h3 id="small-library-for-either">Small library for Either</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">--12/EitherLib.hs</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">module</span> <span class="dt">EitherLib</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="ot">lefts' ::</span> [<span class="dt">Either</span> a b] <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">lefts' es <span class="fu">=</span> foldr f [] es <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">  f (<span class="dt">Left</span> x) acc <span class="fu">=</span> x<span class="fu">:</span>acc</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">  f _ acc <span class="fu">=</span> acc</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="ot">rights' ::</span> [<span class="dt">Either</span> a b] <span class="ot">-&gt;</span> [b]</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">rights' es <span class="fu">=</span> foldr f [] es <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">  f (<span class="dt">Right</span> x) acc <span class="fu">=</span> x<span class="fu">:</span>acc</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">  f _ acc <span class="fu">=</span> acc</a>
<a class="sourceLine" id="cb4-13" data-line-number="13"></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="ot">partitionEithers' ::</span> [<span class="dt">Either</span> a b] <span class="ot">-&gt;</span> ([a], [b])</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">partitionEithers' es <span class="fu">=</span> (lefts' es, rights' es)</a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="ot">eitherMaybe' ::</span> (b <span class="ot">-&gt;</span> c) <span class="ot">-&gt;</span> <span class="dt">Either</span> a b <span class="ot">-&gt;</span> <span class="dt">Maybe</span> c</a>
<a class="sourceLine" id="cb4-18" data-line-number="18">eitherMaybe' f (<span class="dt">Left</span> a) <span class="fu">=</span> <span class="dt">Nothing</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19">eitherMaybe' f (<span class="dt">Right</span> b) <span class="fu">=</span> <span class="dt">Just</span> <span class="fu">$</span> f b</a>
<a class="sourceLine" id="cb4-20" data-line-number="20"></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="ot">either' ::</span> (a <span class="ot">-&gt;</span> c) <span class="ot">-&gt;</span> (b <span class="ot">-&gt;</span> c) <span class="ot">-&gt;</span> <span class="dt">Either</span> a b <span class="ot">-&gt;</span> c</a>
<a class="sourceLine" id="cb4-22" data-line-number="22">either' f g (<span class="dt">Left</span> a) <span class="fu">=</span> f a</a>
<a class="sourceLine" id="cb4-23" data-line-number="23">either' f g (<span class="dt">Right</span> b) <span class="fu">=</span> g b</a>
<a class="sourceLine" id="cb4-24" data-line-number="24"></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="ot">eitherMaybe'' ::</span> (b <span class="ot">-&gt;</span> c) <span class="ot">-&gt;</span> <span class="dt">Either</span> a b <span class="ot">-&gt;</span> <span class="dt">Maybe</span> c</a>
<a class="sourceLine" id="cb4-26" data-line-number="26">eitherMaybe'' f e <span class="fu">=</span> either' (const <span class="dt">Nothing</span>) (<span class="dt">Just</span> <span class="fu">.</span> f) e</a></code></pre></div>
<h3 id="write-your-own-iterate-and-unfoldr">Write your own iterate and unfoldr</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">--12/Unfolds.hs</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">module</span> <span class="dt">Unfolds</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Data.List</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="ot">myIterate ::</span> (a <span class="ot">-&gt;</span> a) <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">myIterate f a <span class="fu">=</span> a <span class="fu">:</span> myIterate f (f a)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="ot">myUnfoldr ::</span> (b <span class="ot">-&gt;</span> <span class="dt">Maybe</span> (a, b)) <span class="ot">-&gt;</span> b <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">myUnfoldr f s <span class="fu">=</span> go f s (f s) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">  go f s <span class="dt">Nothing</span> <span class="fu">=</span> []</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">  go f s (<span class="dt">Just</span> (a, b)) <span class="fu">=</span> a <span class="fu">:</span> go f b (f b)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="ot">betterIterate ::</span> (a <span class="ot">-&gt;</span> a) <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">betterIterate f s <span class="fu">=</span> myUnfoldr (g f) s <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16">  g f s <span class="fu">=</span> <span class="dt">Just</span> (s, (f s))</a></code></pre></div>
<h3 id="finally-something-other-than-a-list">Finally something other than a list</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">--12/BinaryTreeUnfold.hs</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">module</span> <span class="dt">BinaryTreeUnfold</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw">data</span> <span class="dt">BinaryTree</span> a <span class="fu">=</span> <span class="dt">Leaf</span> <span class="fu">|</span> <span class="dt">Node</span> (<span class="dt">BinaryTree</span> a) a (<span class="dt">BinaryTree</span> a)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">                    <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>, <span class="dt">Ord</span>)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="ot">unfold ::</span> (a <span class="ot">-&gt;</span> <span class="dt">Maybe</span> (a, b, a)) <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> b</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">unfold f s <span class="fu">=</span> <span class="kw">case</span> f s <span class="kw">of</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="dt">Leaf</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  <span class="dt">Just</span> (l, v, r) <span class="ot">-&gt;</span> <span class="dt">Node</span> (unfold f l) v (unfold f r)</a>
<a class="sourceLine" id="cb6-11" data-line-number="11"></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="ot">treeBuild ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">BinaryTree</span> <span class="dt">Integer</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13">treeBuild n <span class="fu">=</span> unfold (f n) <span class="dv">0</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">  f n x <span class="fu">=</span> <span class="kw">if</span> x <span class="fu">&gt;=</span> n <span class="kw">then</span> <span class="dt">Nothing</span> <span class="kw">else</span> <span class="dt">Just</span> (x<span class="fu">+</span><span class="dv">1</span>, x, x<span class="fu">+</span><span class="dv">1</span>)</a></code></pre></div>

        </div>
        <div id="footer">
          <p>&copy; <script>document.write(new Date().getFullYear());</script>
             John Chandler Burnham.
            Generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>
          </p>
        </div>
    </body>
</html>
