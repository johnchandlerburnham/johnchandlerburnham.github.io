<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>John Chandler Burnham - Notes (HPFP 10/31): Folding Lists</title>
        <link rel="stylesheet" type="text/css" href="../../css/default.css" />
    </head>
    <body>
        <div id="header">
            <div id="navigation">
                <a href="../../">jcb</a>
                <a href="../../posts.html">posts</a>
                <a href="../../projects.html">projects</a>
                <a href="https://github.com/johnchandlerburnham">github</a>
                <a href="https://twitter.com/John_C_Burnham">twitter</a>
            </div>
        </div>
        <div id="content">
            <h1>Notes (HPFP 10/31): Folding Lists</h1>
          <div id="title" class="info">
    Posted on November  1, 2017
    
        by jcb
    
<hr>
</div>

<h1 id="folding-lists">10 Folding lists</h1>
<p>Okay, so here’s the thing about the term “catamorphism”:</p>
<p>“Kata” in Greek means “down”. The opposite of “kata” is “ana” which means “up”.</p>
<p>So we have “catamorphisms” and “anamorphisms”. Remember that “morph” means “form”, so a “catamorphism” is a “down-form thing” and an “anamorphism” is an “up-form thing”.</p>
<p>But what the heck do “up” and “down” have to do with “forms”. There’s a metaphor that recurs (so to speak) again and again in functional programming between height and complexity: Things that have more structure are upwards and things that have less structure are downwards. It’s like a tall building: the more structure you have the higher you go.</p>
<p>So an <code>Integer</code> is pretty simple, and is downwards of <code>[Integer]</code> or <code>Maybe Integer</code> or <code>Map String Integer</code>.</p>
<p>Functions that go “upwards” in this complexity-space, like from <code>Integer -&gt; [Integer]</code> are, roughly speaking, anamorphisms. Functions that go “downwards” are catamorphisms.</p>
<h2 id="fold-right">10.4 Fold right</h2>
<h3 id="exercises-understanding-folds">Exercises: Understanding folds</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">module</span> <span class="dt">Folds</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">-- 1:</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">one <span class="fu">=</span> (<span class="fu">==</span>) (foldr (<span class="fu">*</span>) <span class="dv">1</span> [<span class="dv">1</span><span class="fu">..</span><span class="dv">5</span>]) (foldl (<span class="fu">*</span>) <span class="dv">1</span> [<span class="dv">1</span><span class="fu">..</span><span class="dv">5</span>])</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">-- 2</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">two <span class="fu">=</span> scanl (flip (<span class="fu">*</span>)) <span class="dv">1</span> [<span class="dv">1</span><span class="fu">..</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">--3: c</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">--4: reduce structure</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">--5</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">fiveA <span class="fu">=</span> foldr (<span class="fu">++</span>) <span class="st">&quot;&quot;</span> [<span class="st">&quot;woot&quot;</span>, <span class="st">&quot;WOOT&quot;</span>, <span class="st">&quot;woot&quot;</span>]</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">fiveB <span class="fu">=</span> foldr max <span class="ch">'a'</span> <span class="st">&quot;fear is the little death&quot;</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">fiveC <span class="fu">=</span> foldr (<span class="fu">&amp;&amp;</span>) <span class="dt">True</span> [<span class="dt">False</span>, <span class="dt">True</span>]</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">fiveD <span class="fu">=</span> foldr (<span class="fu">||</span>) <span class="dt">True</span> [<span class="dt">False</span>, <span class="dt">True</span>]</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">fiveE <span class="fu">=</span> foldr ((<span class="fu">++</span>) <span class="fu">.</span> show) <span class="st">&quot;&quot;</span> [<span class="dv">1</span><span class="fu">..</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb1-19" data-line-number="19">fiveF <span class="fu">=</span> foldl const <span class="ch">'a'</span>  [<span class="dv">1</span><span class="fu">..</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">fiveG <span class="fu">=</span> foldl const <span class="dv">0</span> <span class="st">&quot;tacos&quot;</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21">fiveH <span class="fu">=</span> foldr (flip const) <span class="dv">0</span> <span class="st">&quot;burritos&quot;</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22">fiveI <span class="fu">=</span> foldr (flip const) <span class="ch">'z'</span> [<span class="dv">1</span><span class="fu">..</span><span class="dv">5</span>]</a></code></pre></div>
<h3 id="exercises-database-processing">Exercises: Database Processing</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">module</span> <span class="dt">DatabaseProcessing</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">import</span> <span class="dt">Data.Time</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">data</span> <span class="dt">DatabaseItem</span> <span class="fu">=</span> <span class="dt">DbString</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">                 <span class="fu">|</span> <span class="dt">DbNumber</span> <span class="dt">Integer</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">                 <span class="fu">|</span> <span class="dt">DbDate</span>   <span class="dt">UTCTime</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">                 <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Ord</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="ot">theDatabase ::</span> [<span class="dt">DatabaseItem</span>]</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">theDatabase <span class="fu">=</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"> [ <span class="dt">DbDate</span> (<span class="dt">UTCTime</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">           (fromGregorian <span class="dv">1911</span> <span class="dv">5</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">           (secondsToDiffTime <span class="dv">34123</span>))</a>
<a class="sourceLine" id="cb2-15" data-line-number="15"> , <span class="dt">DbNumber</span> <span class="dv">9001</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"> , <span class="dt">DbString</span> <span class="st">&quot;Hello, World!&quot;</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"> , <span class="dt">DbDate</span> (<span class="dt">UTCTime</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18">           (fromGregorian <span class="dv">1921</span> <span class="dv">5</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">           (secondsToDiffTime <span class="dv">34123</span>))</a>
<a class="sourceLine" id="cb2-20" data-line-number="20"> ]</a>
<a class="sourceLine" id="cb2-21" data-line-number="21"></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">-- 1</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="ot">filterDbDate ::</span> [<span class="dt">DatabaseItem</span>] <span class="ot">-&gt;</span> [<span class="dt">UTCTime</span>]</a>
<a class="sourceLine" id="cb2-24" data-line-number="24">filterDbDate <span class="fu">=</span> map unpack <span class="fu">.</span> filter isADbDate <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"> isADbDate (<span class="dt">DbDate</span> _) <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"> isADbDate _ <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"> unpack (<span class="dt">DbDate</span> utc) <span class="fu">=</span> utc</a>
<a class="sourceLine" id="cb2-28" data-line-number="28"></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="ot">filterDbDate2 ::</span> [<span class="dt">DatabaseItem</span>] <span class="ot">-&gt;</span> [<span class="dt">UTCTime</span>]</a>
<a class="sourceLine" id="cb2-30" data-line-number="30">filterDbDate2 <span class="fu">=</span> foldr unpackDate [] <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"> unpackDate (<span class="dt">DbDate</span> utc) acc <span class="fu">=</span> utc <span class="fu">:</span> acc</a>
<a class="sourceLine" id="cb2-32" data-line-number="32"> unpackDate _ acc <span class="fu">=</span> acc</a>
<a class="sourceLine" id="cb2-33" data-line-number="33"></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co">-- 2</span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35"><span class="ot">filterDbNumber ::</span> [<span class="dt">DatabaseItem</span>] <span class="ot">-&gt;</span> [<span class="dt">Integer</span>]</a>
<a class="sourceLine" id="cb2-36" data-line-number="36">filterDbNumber <span class="fu">=</span> foldr unpackNum [] <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-37" data-line-number="37"> unpackNum (<span class="dt">DbNumber</span> num) acc <span class="fu">=</span> num <span class="fu">:</span> acc</a>
<a class="sourceLine" id="cb2-38" data-line-number="38"> unpackNum _ acc <span class="fu">=</span> acc</a>
<a class="sourceLine" id="cb2-39" data-line-number="39"></a>
<a class="sourceLine" id="cb2-40" data-line-number="40"><span class="co">-- 3</span></a>
<a class="sourceLine" id="cb2-41" data-line-number="41"><span class="ot">mostRecent ::</span> [<span class="dt">DatabaseItem</span>] <span class="ot">-&gt;</span> <span class="dt">UTCTime</span></a>
<a class="sourceLine" id="cb2-42" data-line-number="42">mostRecent db <span class="fu">=</span> foldr compareDate base db <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-43" data-line-number="43"> compareDate (<span class="dt">DbDate</span> utc) acc <span class="fu">=</span> max utc acc</a>
<a class="sourceLine" id="cb2-44" data-line-number="44"> compareDate _ acc <span class="fu">=</span> acc</a>
<a class="sourceLine" id="cb2-45" data-line-number="45"> base <span class="fu">=</span> (filterDbDate2 db) <span class="fu">!!</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-46" data-line-number="46"></a>
<a class="sourceLine" id="cb2-47" data-line-number="47"><span class="co">-- 4</span></a>
<a class="sourceLine" id="cb2-48" data-line-number="48"><span class="ot">sumDb ::</span> [<span class="dt">DatabaseItem</span>] <span class="ot">-&gt;</span> <span class="dt">Integer</span></a>
<a class="sourceLine" id="cb2-49" data-line-number="49">sumDb <span class="fu">=</span> foldr addNum <span class="dv">0</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-50" data-line-number="50"> addNum (<span class="dt">DbNumber</span> int) acc <span class="fu">=</span> int <span class="fu">+</span> acc</a>
<a class="sourceLine" id="cb2-51" data-line-number="51"> addNum _ acc <span class="fu">=</span> acc</a>
<a class="sourceLine" id="cb2-52" data-line-number="52"></a>
<a class="sourceLine" id="cb2-53" data-line-number="53"><span class="co">-- 5</span></a>
<a class="sourceLine" id="cb2-54" data-line-number="54"><span class="ot">avgDb ::</span> [<span class="dt">DatabaseItem</span>] <span class="ot">-&gt;</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb2-55" data-line-number="55">avgDb db <span class="fu">=</span> (fromIntegral <span class="fu">$</span> fst tup) <span class="fu">/</span> (fromIntegral <span class="fu">$</span> snd tup) <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-56" data-line-number="56"> tup <span class="fu">=</span> foldr addNum (<span class="dv">0</span>,<span class="dv">0</span>) db</a>
<a class="sourceLine" id="cb2-57" data-line-number="57"> addNum (<span class="dt">DbNumber</span> int) (num,den) <span class="fu">=</span> (int <span class="fu">+</span> num, den <span class="fu">+</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-58" data-line-number="58"> addNum _ acc <span class="fu">=</span> acc</a>
<a class="sourceLine" id="cb2-59" data-line-number="59"></a>
<a class="sourceLine" id="cb2-60" data-line-number="60"><span class="ot">avgDb2 ::</span> [<span class="dt">DatabaseItem</span>] <span class="ot">-&gt;</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb2-61" data-line-number="61">avgDb2 db <span class="fu">=</span> n <span class="fu">/</span> d <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-62" data-line-number="62"> n <span class="fu">=</span> (fromIntegral <span class="fu">$</span> sumDb db)</a>
<a class="sourceLine" id="cb2-63" data-line-number="63"> d <span class="fu">=</span> (fromIntegral <span class="fu">$</span> length <span class="fu">$</span> filterDbNumber db)</a></code></pre></div>
<h2 id="scans">10.9 Scans</h2>
<h3 id="scans-exercises">Scans Exercises</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">module</span> <span class="dt">Scans</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">fibs <span class="fu">=</span> <span class="dv">1</span> <span class="fu">:</span> scanl (<span class="fu">+</span>) <span class="dv">1</span> fibs</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">fibsN x <span class="fu">=</span> fibs <span class="fu">!!</span> x</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">--1</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">fibsToN n <span class="fu">=</span> take n <span class="fu">$</span> fibs</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">--2</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10">fibsLessThan n <span class="fu">=</span> takeWhile (<span class="fu">&lt;</span> n) fibs</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">--3</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">factorials <span class="fu">=</span> <span class="dv">1</span> <span class="fu">:</span> scanl ratio <span class="dv">1</span> factorials</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"> <span class="kw">where</span> ratio m n <span class="fu">=</span> (m <span class="ot">`div`</span> n <span class="fu">+</span> <span class="dv">1</span>) <span class="fu">*</span> m</a>
<a class="sourceLine" id="cb3-15" data-line-number="15"></a>
<a class="sourceLine" id="cb3-16" data-line-number="16">factorials2 <span class="fu">=</span> scanl (<span class="fu">*</span>) <span class="dv">1</span> [<span class="dv">1</span><span class="fu">..</span>]</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">lazyCaterers <span class="fu">=</span> scanl (<span class="fu">+</span>) <span class="dv">1</span> [<span class="dv">1</span><span class="fu">..</span>]</a></code></pre></div>
<h2 id="chapter-exercises">10.10 Chapter Exercises</h2>
<h3 id="warm-up-and-reveiw">Warm-up and reveiw</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">--10/WarmUp.hs</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">module</span> <span class="dt">WarmUp</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">-- 1</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">stops <span class="fu">=</span> <span class="st">&quot;pbtdkg&quot;</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">vowels <span class="fu">=</span> <span class="st">&quot;aeiou&quot;</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">-- 1a</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">stopVowelStop <span class="fu">=</span> [(a, b, c) <span class="fu">|</span> a <span class="ot">&lt;-</span> stops, b <span class="ot">&lt;-</span> vowels, c <span class="ot">&lt;-</span> stops]</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">-- 1b</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12">pVowelStop <span class="fu">=</span> [(<span class="ch">'p'</span>, b, c) <span class="fu">|</span> b <span class="ot">&lt;-</span> vowels, c <span class="ot">&lt;-</span> stops]</a>
<a class="sourceLine" id="cb4-13" data-line-number="13"></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">-- 1c</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15">nouns <span class="fu">=</span> [<span class="st">&quot;cat&quot;</span>, <span class="st">&quot;dog&quot;</span>, <span class="st">&quot;ball&quot;</span>, <span class="st">&quot;box&quot;</span>]</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">verbs <span class="fu">=</span> [<span class="st">&quot;throws&quot;</span>, <span class="st">&quot;catches&quot;</span>, <span class="st">&quot;jumps&quot;</span>, <span class="st">&quot;fetches&quot;</span>]</a>
<a class="sourceLine" id="cb4-17" data-line-number="17"></a>
<a class="sourceLine" id="cb4-18" data-line-number="18">nounVerbNoun <span class="fu">=</span>   [(a, b, c) <span class="fu">|</span> a <span class="ot">&lt;-</span> nouns, b <span class="ot">&lt;-</span> verbs, c <span class="ot">&lt;-</span> nouns]</a>
<a class="sourceLine" id="cb4-19" data-line-number="19"></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">-- 2</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21">seekritFunc x <span class="fu">=</span> div (sum (map length (words x))) (length (words x))</a>
<a class="sourceLine" id="cb4-22" data-line-number="22"></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">-- function is average word length</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="ot">avgWordLength ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Int</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25">avgWordLength x <span class="fu">=</span> div totalWordLengths numberOfWords</a>
<a class="sourceLine" id="cb4-26" data-line-number="26"> <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27">   wordList <span class="fu">=</span> words x</a>
<a class="sourceLine" id="cb4-28" data-line-number="28">   numberOfWords <span class="fu">=</span> length wordList</a>
<a class="sourceLine" id="cb4-29" data-line-number="29">   wordLengths <span class="fu">=</span> map length wordList</a>
<a class="sourceLine" id="cb4-30" data-line-number="30">   totalWordLengths <span class="fu">=</span> sum wordLengths</a>
<a class="sourceLine" id="cb4-31" data-line-number="31"></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">-- 3</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="ot">preciseAvgWordLength ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34">preciseAvgWordLength x <span class="fu">=</span> totalWordLength <span class="fu">/</span> numberOfWords</a>
<a class="sourceLine" id="cb4-35" data-line-number="35"> <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36">   totalWordLength <span class="fu">=</span> fromIntegral <span class="fu">$</span> sum <span class="fu">$</span> map length <span class="fu">$</span> words x</a>
<a class="sourceLine" id="cb4-37" data-line-number="37">   numberOfWords   <span class="fu">=</span> fromIntegral <span class="fu">$</span> length <span class="fu">$</span> words x</a></code></pre></div>
<h3 id="rewriting-functions-using-folds">Rewriting functions using folds</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">--10/FunctionsUsingFolds.hs</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">module</span> <span class="dt">FunctionsUsingFolds</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="ot">myAnd ::</span> [<span class="dt">Bool</span>] <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">myAnd <span class="fu">=</span> foldr (<span class="fu">&amp;&amp;</span>) <span class="dt">True</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">-- 1</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="ot">myOr ::</span> [<span class="dt">Bool</span>] <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">myOr <span class="fu">=</span> foldr (<span class="fu">||</span>) <span class="dt">False</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">-- 2</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="ot">myAny ::</span> (a <span class="ot">-&gt;</span> <span class="dt">Bool</span>) <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13">myAny f x <span class="fu">=</span> foldl check <span class="dt">False</span> x <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"> check x y <span class="fu">=</span> x <span class="fu">||</span> f y</a>
<a class="sourceLine" id="cb5-15" data-line-number="15"></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">-- 3</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="ot">myElem ::</span> <span class="dt">Eq</span> a <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19">myElem x xs <span class="fu">=</span> myAny ((<span class="fu">==</span>) x) xs</a>
<a class="sourceLine" id="cb5-20" data-line-number="20"></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">-- 4</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="ot">myReverse ::</span> [a] <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb5-23" data-line-number="23">myReverse <span class="fu">=</span> foldl (flip (<span class="fu">:</span>)) []</a>
<a class="sourceLine" id="cb5-24" data-line-number="24"></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">-- 5</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="ot">myMap ::</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> [b]</a>
<a class="sourceLine" id="cb5-27" data-line-number="27">myMap f xs <span class="fu">=</span> foldr ((<span class="fu">:</span>) <span class="fu">.</span> f) [] xs</a>
<a class="sourceLine" id="cb5-28" data-line-number="28"></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="co">-- 6</span></a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="ot">myFilter ::</span> (a <span class="ot">-&gt;</span> <span class="dt">Bool</span>) <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb5-31" data-line-number="31">myFilter f xs <span class="fu">=</span>  foldr g [] xs <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-32" data-line-number="32"> g x y <span class="fu">=</span> <span class="kw">if</span> (f x) <span class="kw">then</span> (x <span class="fu">:</span> y) <span class="kw">else</span> y</a>
<a class="sourceLine" id="cb5-33" data-line-number="33"></a>
<a class="sourceLine" id="cb5-34" data-line-number="34"><span class="co">-- 7</span></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="ot">squish ::</span> [[a]] <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb5-36" data-line-number="36">squish <span class="fu">=</span> foldr (<span class="fu">++</span>) []</a>
<a class="sourceLine" id="cb5-37" data-line-number="37"></a>
<a class="sourceLine" id="cb5-38" data-line-number="38"><span class="co">-- 8</span></a>
<a class="sourceLine" id="cb5-39" data-line-number="39"><span class="ot">squishMap ::</span> (a <span class="ot">-&gt;</span> [b]) <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> [b]</a>
<a class="sourceLine" id="cb5-40" data-line-number="40">squishMap f <span class="fu">=</span> foldr ((<span class="fu">++</span>) <span class="fu">.</span> f) []</a>
<a class="sourceLine" id="cb5-41" data-line-number="41"></a>
<a class="sourceLine" id="cb5-42" data-line-number="42"><span class="co">-- 9</span></a>
<a class="sourceLine" id="cb5-43" data-line-number="43"><span class="ot">squishAgain ::</span> [[a]] <span class="ot">-&gt;</span> [a]</a>
<a class="sourceLine" id="cb5-44" data-line-number="44">squishAgain <span class="fu">=</span> squishMap id</a>
<a class="sourceLine" id="cb5-45" data-line-number="45"></a>
<a class="sourceLine" id="cb5-46" data-line-number="46"><span class="co">-- 10</span></a>
<a class="sourceLine" id="cb5-47" data-line-number="47"><span class="ot">myMaximumBy ::</span> (a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Ordering</span>) <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb5-48" data-line-number="48">myMaximumBy ord xs <span class="fu">=</span> foldr1 g xs</a>
<a class="sourceLine" id="cb5-49" data-line-number="49"> <span class="kw">where</span> g x y <span class="fu">=</span> <span class="kw">if</span> (ord x y) <span class="fu">==</span> <span class="dt">GT</span> <span class="kw">then</span> x <span class="kw">else</span> y</a>
<a class="sourceLine" id="cb5-50" data-line-number="50"></a>
<a class="sourceLine" id="cb5-51" data-line-number="51"><span class="co">-- 11</span></a>
<a class="sourceLine" id="cb5-52" data-line-number="52"><span class="ot">myMinimumBy ::</span> (a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Ordering</span>) <span class="ot">-&gt;</span> [a] <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb5-53" data-line-number="53">myMinimumBy ord xs <span class="fu">=</span> foldr1 g xs</a>
<a class="sourceLine" id="cb5-54" data-line-number="54"> <span class="kw">where</span> g x y <span class="fu">=</span> <span class="kw">if</span> (ord x y) <span class="fu">==</span> <span class="dt">LT</span> <span class="kw">then</span> x <span class="kw">else</span> y</a></code></pre></div>
<h2 id="follow-up-resources">10.12 Follow-up resources</h2>
<ol type="1">
<li><p><a href="https://wiki.haskell.org/Fold">Haskell Wiki. Fold.</a></p></li>
<li><p><a href="Programming%20using%20Haskell%20(1998).">Richard Bird. Sections 4.5 and 4.6 of Introduction to Functional</a></p></li>
<li><p>Antoni Diller. Introduction to Haskell.</p></li>
<li><p><a href="http://www.cs.nott.ac.uk/~gmh/fold.pdf">Graham Hutton. A tutorial on the universality and expressive- ness of fold.</a></p></li>
</ol>
<hr />

        </div>
        <div id="footer">
          <p>&copy; <script>document.write(new Date().getFullYear());</script>
             John Chandler Burnham.
            Generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>
          </p>
        </div>
    </body>
</html>
