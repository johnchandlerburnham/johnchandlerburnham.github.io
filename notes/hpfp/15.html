<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>John Chandler Burnham - Notes (HPFP 15/31): Monoid, Semigroup</title>
        <link rel="stylesheet" type="text/css" href="../../css/default.css" />
    </head>
    <body>
        <div id="header">
            <div id="navigation">
                <a href="../../">jcb</a>
                <a href="../../posts.html">posts</a>
                <a href="../../projects.html">projects</a>
                <a href="https://github.com/johnchandlerburnham">github</a>
                <a href="https://twitter.com/John_C_Burnham">twitter</a>
            </div>
        </div>
        <div id="content">
            <h1>Notes (HPFP 15/31): Monoid, Semigroup</h1>
          <div id="title" class="info">
    Posted on November  1, 2017
    
        by jcb
    
<hr>
</div>

<h1 id="monoid-semigroup">15 Monoid, Semigroup</h1>
<h2 id="reusing-algebras-by-asking-for-algebras">15.10 Reusing algebras by asking for algebras</h2>
<h3 id="exercise-optional-monoid">Exercise: Optional Monoid</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">--15/Optional.hs</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">module</span> <span class="dt">Optional</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Data.Monoid</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">data</span> <span class="dt">Optional</span> a <span class="fu">=</span> <span class="dt">Nada</span> <span class="fu">|</span> <span class="dt">Only</span> a <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">instance</span> <span class="dt">Monoid</span> a <span class="ot">=&gt;</span> <span class="dt">Monoid</span> (<span class="dt">Optional</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  mempty <span class="fu">=</span> <span class="dt">Nada</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  mappend <span class="dt">Nada</span> <span class="dt">Nada</span> <span class="fu">=</span> <span class="dt">Nada</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">  mappend <span class="dt">Nada</span> (<span class="dt">Only</span> x) <span class="fu">=</span> (<span class="dt">Only</span> x)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  mappend (<span class="dt">Only</span> x) <span class="dt">Nada</span> <span class="fu">=</span> (<span class="dt">Only</span> x)</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">  mappend (<span class="dt">Only</span> x) (<span class="dt">Only</span> y) <span class="fu">=</span> (<span class="dt">Only</span> (mappend x y))</a></code></pre></div>
<h2 id="madness">15.11 Madness</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">--15/Madness.hs</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">module</span> <span class="dt">Madness</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Data.Monoid</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw">type</span> <span class="dt">Verb</span> <span class="fu">=</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw">type</span> <span class="dt">Adjective</span> <span class="fu">=</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="kw">type</span> <span class="dt">Adverb</span> <span class="fu">=</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="kw">type</span> <span class="dt">Noun</span> <span class="fu">=</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="kw">type</span> <span class="dt">Exclamation</span> <span class="fu">=</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="ot">madlibbin' ::</span> <span class="dt">Exclamation</span> <span class="ot">-&gt;</span> <span class="dt">Adverb</span> <span class="ot">-&gt;</span> <span class="dt">Noun</span> <span class="ot">-&gt;</span> <span class="dt">Adjective</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">madlibbin' e adv noun adj <span class="fu">=</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">  e <span class="fu">&lt;&gt;</span> <span class="st">&quot;! he said&quot;</span> <span class="fu">&lt;&gt;</span> adv <span class="fu">&lt;&gt;</span> <span class="st">&quot; as he jumped into his car &quot;</span> <span class="fu">&lt;&gt;</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15">  noun  <span class="fu">&lt;&gt;</span> <span class="st">&quot; and drove off with his &quot;</span> <span class="fu">&lt;&gt;</span> adj <span class="fu">&lt;&gt;</span> <span class="st">&quot; wife.&quot;</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="ot">madlibbinBetter' ::</span> <span class="dt">Exclamation</span> <span class="ot">-&gt;</span> <span class="dt">Adverb</span> <span class="ot">-&gt;</span> <span class="dt">Noun</span> <span class="ot">-&gt;</span> <span class="dt">Adjective</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18">madlibbinBetter' e adv noun adj <span class="fu">=</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">  mconcat [ e, <span class="st">&quot;! he said&quot;</span>, adv, <span class="st">&quot; as he jumped into his car &quot;</span>, noun</a>
<a class="sourceLine" id="cb2-20" data-line-number="20">          , <span class="st">&quot; and drove off with his &quot;</span>, adj,  <span class="st">&quot; wife.&quot;</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21">          ]</a></code></pre></div>
<h2 id="better-living-through-quickcheck">15.12 Better living through QuickCheck</h2>
<h3 id="testing-quickchecks-patience">Testing QuickCheckâ€™s patience</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co">--15/Patience.hs</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">module</span> <span class="dt">Patience</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Control.Monad</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw">import</span> <span class="dt">Data.Monoid</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="kw">import</span> <span class="dt">Test.QuickCheck</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="kw">data</span> <span class="dt">Bull</span> <span class="fu">=</span> <span class="dt">Fools</span> <span class="fu">|</span> <span class="dt">Twoo</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="kw">instance</span> <span class="dt">Arbitrary</span> <span class="dt">Bull</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  arbitrary <span class="fu">=</span> frequency [ (<span class="dv">1</span>, return <span class="dt">Fools</span>), (<span class="dv">1</span>, return <span class="dt">Twoo</span>) ]</a>
<a class="sourceLine" id="cb3-12" data-line-number="12"></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="kw">instance</span> <span class="dt">Monoid</span> <span class="dt">Bull</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14">  mempty <span class="fu">=</span> <span class="dt">Fools</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15">  mappend _ _ <span class="fu">=</span> <span class="dt">Fools</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="kw">type</span> <span class="dt">BullMappend</span> <span class="fu">=</span> <span class="dt">Bull</span> <span class="ot">-&gt;</span> <span class="dt">Bull</span> <span class="ot">-&gt;</span> <span class="dt">Bull</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="ot">monoidAssoc ::</span> (<span class="dt">Eq</span> m, <span class="dt">Monoid</span> m) <span class="ot">=&gt;</span> m <span class="ot">-&gt;</span> m <span class="ot">-&gt;</span> m <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20">monoidAssoc a b c <span class="fu">=</span> (a <span class="fu">&lt;&gt;</span> (b <span class="fu">&lt;&gt;</span> c)) <span class="fu">==</span> ((a <span class="fu">&lt;&gt;</span> b) <span class="fu">&lt;&gt;</span> c)</a>
<a class="sourceLine" id="cb3-21" data-line-number="21"></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="ot">monoidLeftIdentity ::</span> (<span class="dt">Eq</span> m, <span class="dt">Monoid</span> m) <span class="ot">=&gt;</span> m <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23">monoidLeftIdentity a <span class="fu">=</span> (mempty <span class="fu">&lt;&gt;</span> a) <span class="fu">==</span> a</a>
<a class="sourceLine" id="cb3-24" data-line-number="24"></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="ot">monoidRightIdentity ::</span> (<span class="dt">Eq</span> m, <span class="dt">Monoid</span> m) <span class="ot">=&gt;</span> m <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26">monoidRightIdentity a <span class="fu">=</span> (a <span class="fu">&lt;&gt;</span> mempty) <span class="fu">==</span> a</a>
<a class="sourceLine" id="cb3-27" data-line-number="27"></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="ot">main ::</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb3-29" data-line-number="29">main <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30">  <span class="kw">let</span> ma <span class="fu">=</span> monoidAssoc</a>
<a class="sourceLine" id="cb3-31" data-line-number="31">      mli <span class="fu">=</span> monoidLeftIdentity</a>
<a class="sourceLine" id="cb3-32" data-line-number="32">      mlr <span class="fu">=</span> monoidRightIdentity</a>
<a class="sourceLine" id="cb3-33" data-line-number="33">  quickCheck (<span class="ot">ma ::</span> <span class="dt">BullMappend</span>)</a>
<a class="sourceLine" id="cb3-34" data-line-number="34">  quickCheck (<span class="ot">mli ::</span> <span class="dt">Bull</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb3-35" data-line-number="35">  quickCheck (<span class="ot">mlr ::</span> <span class="dt">Bull</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a></code></pre></div>
<h3 id="exercise-maybe-another-monoid">Exercise: Maybe Another Monoid</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">--15/MaybeAnother.hs</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">module</span> <span class="dt">MaybeAnother</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Control.Monad</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="kw">import</span> <span class="dt">Data.Monoid</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="kw">import</span> <span class="dt">Test.QuickCheck</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="kw">data</span> <span class="dt">Optional</span> a <span class="fu">=</span> <span class="dt">Nada</span> <span class="fu">|</span> <span class="dt">Only</span> a <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="kw">instance</span> <span class="dt">Monoid</span> a <span class="ot">=&gt;</span> <span class="dt">Monoid</span> (<span class="dt">Optional</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">  mempty <span class="fu">=</span> <span class="dt">Nada</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12">  mappend <span class="dt">Nada</span> <span class="dt">Nada</span> <span class="fu">=</span> <span class="dt">Nada</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13">  mappend <span class="dt">Nada</span> (<span class="dt">Only</span> x) <span class="fu">=</span> (<span class="dt">Only</span> x)</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">  mappend (<span class="dt">Only</span> x) <span class="dt">Nada</span> <span class="fu">=</span> (<span class="dt">Only</span> x)</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">  mappend (<span class="dt">Only</span> x) (<span class="dt">Only</span> y) <span class="fu">=</span> (<span class="dt">Only</span> (mappend x y))</a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="kw">newtype</span> <span class="dt">First'</span> a <span class="fu">=</span> <span class="dt">First'</span> {<span class="ot"> getFirst' ::</span> <span class="dt">Optional</span> a } <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb4-18" data-line-number="18"></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="kw">instance</span> <span class="dt">Arbitrary</span> a <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">First'</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20">  arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21">    a <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb4-22" data-line-number="22">    oneof [return (<span class="dt">First'</span> (<span class="dt">Only</span> a)), return (<span class="dt">First'</span> <span class="dt">Nada</span>)]</a>
<a class="sourceLine" id="cb4-23" data-line-number="23"></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="kw">instance</span> <span class="dt">Monoid</span> (<span class="dt">First'</span> a ) <span class="kw">where</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25">  mempty <span class="fu">=</span> <span class="dt">First'</span> <span class="dt">Nada</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26">  mappend (<span class="dt">First'</span> <span class="dt">Nada</span>) (<span class="dt">First'</span> <span class="dt">Nada</span>) <span class="fu">=</span> (<span class="dt">First'</span> <span class="dt">Nada</span>)</a>
<a class="sourceLine" id="cb4-27" data-line-number="27">  mappend (<span class="dt">First'</span> <span class="dt">Nada</span>) (<span class="dt">First'</span> (<span class="dt">Only</span> x)) <span class="fu">=</span> (<span class="dt">First'</span> (<span class="dt">Only</span> x))</a>
<a class="sourceLine" id="cb4-28" data-line-number="28">  mappend (<span class="dt">First'</span> (<span class="dt">Only</span> x)) _ <span class="fu">=</span> (<span class="dt">First'</span> (<span class="dt">Only</span> x))</a>
<a class="sourceLine" id="cb4-29" data-line-number="29"></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="kw">type</span> <span class="dt">FirstMappend</span> <span class="fu">=</span> <span class="dt">First'</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">First'</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">First'</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="kw">type</span> <span class="dt">FstId</span> <span class="fu">=</span> <span class="dt">First'</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="ot">monoidAssoc ::</span> (<span class="dt">Eq</span> m, <span class="dt">Monoid</span> m) <span class="ot">=&gt;</span> m <span class="ot">-&gt;</span> m <span class="ot">-&gt;</span> m <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35">monoidAssoc a b c <span class="fu">=</span> (a <span class="fu">&lt;&gt;</span> (b <span class="fu">&lt;&gt;</span> c)) <span class="fu">==</span> ((a <span class="fu">&lt;&gt;</span> b) <span class="fu">&lt;&gt;</span> c)</a>
<a class="sourceLine" id="cb4-36" data-line-number="36"></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="ot">monoidLeftIdentity ::</span> (<span class="dt">Eq</span> m, <span class="dt">Monoid</span> m) <span class="ot">=&gt;</span> m <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38">monoidLeftIdentity a <span class="fu">=</span> (mempty <span class="fu">&lt;&gt;</span> a) <span class="fu">==</span> a</a>
<a class="sourceLine" id="cb4-39" data-line-number="39"></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"><span class="ot">monoidRightIdentity ::</span> (<span class="dt">Eq</span> m, <span class="dt">Monoid</span> m) <span class="ot">=&gt;</span> m <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb4-41" data-line-number="41">monoidRightIdentity a <span class="fu">=</span> (a <span class="fu">&lt;&gt;</span> mempty) <span class="fu">==</span> a</a>
<a class="sourceLine" id="cb4-42" data-line-number="42"></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="ot">main ::</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb4-44" data-line-number="44">main <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45">  quickCheck (<span class="ot">monoidAssoc ::</span> <span class="dt">FirstMappend</span>)</a>
<a class="sourceLine" id="cb4-46" data-line-number="46">  quickCheck (<span class="ot">monoidLeftIdentity ::</span> <span class="dt">FstId</span>)</a>
<a class="sourceLine" id="cb4-47" data-line-number="47">  quickCheck (<span class="ot">monoidRightIdentity ::</span> <span class="dt">FstId</span>)</a></code></pre></div>
<h2 id="chapter-exercises">15.15 Chapter Exercises</h2>
<h3 id="semigroup-exercises-monoid-exercises">Semigroup exercises &amp; Monoid exercises</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">--15/SemigroupMonoidExercises.hs</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">module</span> <span class="dt">SemigroupMonoidExercises</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Test.QuickCheck</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="kw">import</span> <span class="dt">Test.QuickCheck.Gen.Unsafe</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="kw">import</span> <span class="dt">Data.Semigroup</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Monoid</span> <span class="kw">as</span> <span class="dt">M</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">-- 1</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="kw">data</span> <span class="dt">Trivial</span> <span class="fu">=</span> <span class="dt">Trivial</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="kw">instance</span> <span class="dt">Semigroup</span> <span class="dt">Trivial</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13">  _ <span class="fu">&lt;&gt;</span> _ <span class="fu">=</span> <span class="dt">Trivial</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="kw">instance</span> <span class="dt">Monoid</span> <span class="dt">Trivial</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16">  mempty <span class="fu">=</span> <span class="dt">Trivial</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17">  mappend <span class="fu">=</span> (<span class="fu">&lt;&gt;</span>)</a>
<a class="sourceLine" id="cb5-18" data-line-number="18"></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="kw">instance</span> <span class="dt">Arbitrary</span> <span class="dt">Trivial</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20">  arbitrary <span class="fu">=</span> return <span class="dt">Trivial</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="kw">type</span> <span class="dt">TrivAssoc</span> <span class="fu">=</span> <span class="dt">Trivial</span> <span class="ot">-&gt;</span> <span class="dt">Trivial</span> <span class="ot">-&gt;</span> <span class="dt">Trivial</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">-- 2</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="kw">newtype</span> <span class="dt">Identity</span> a <span class="fu">=</span> <span class="dt">Identity</span> a <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb5-26" data-line-number="26"></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="kw">instance</span> <span class="dt">Arbitrary</span> a <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Identity</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28">  arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29">    a' <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-30" data-line-number="30">    return (<span class="dt">Identity</span> a')</a>
<a class="sourceLine" id="cb5-31" data-line-number="31"></a>
<a class="sourceLine" id="cb5-32" data-line-number="32"><span class="kw">instance</span> (<span class="dt">Semigroup</span> a) <span class="ot">=&gt;</span> <span class="dt">Semigroup</span> (<span class="dt">Identity</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-33" data-line-number="33">  (<span class="dt">Identity</span> a1) <span class="fu">&lt;&gt;</span> (<span class="dt">Identity</span> a2) <span class="fu">=</span> (<span class="dt">Identity</span> (a1 <span class="fu">&lt;&gt;</span> a2))</a>
<a class="sourceLine" id="cb5-34" data-line-number="34"></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="kw">instance</span> (<span class="dt">Monoid</span> a) <span class="ot">=&gt;</span> <span class="dt">Monoid</span> (<span class="dt">Identity</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-36" data-line-number="36">  mempty <span class="fu">=</span> <span class="dt">Identity</span> mempty</a>
<a class="sourceLine" id="cb5-37" data-line-number="37">  mappend (<span class="dt">Identity</span> a) (<span class="dt">Identity</span> b) <span class="fu">=</span> <span class="dt">Identity</span> ((<span class="fu">M.&lt;&gt;</span>) a b)</a>
<a class="sourceLine" id="cb5-38" data-line-number="38"></a>
<a class="sourceLine" id="cb5-39" data-line-number="39"><span class="co">-- instance Semigroup (Identity a) where</span></a>
<a class="sourceLine" id="cb5-40" data-line-number="40"><span class="co">--  (Identity a) &lt;&gt; _ = (Identity a)</span></a>
<a class="sourceLine" id="cb5-41" data-line-number="41"></a>
<a class="sourceLine" id="cb5-42" data-line-number="42"><span class="kw">type</span> <span class="dt">IdentAssoc</span> <span class="fu">=</span> <span class="dt">Identity</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Identity</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Identity</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-43" data-line-number="43"></a>
<a class="sourceLine" id="cb5-44" data-line-number="44"><span class="co">-- 3</span></a>
<a class="sourceLine" id="cb5-45" data-line-number="45"><span class="kw">data</span> <span class="dt">Two</span> a b <span class="fu">=</span> <span class="dt">Two</span> a b <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb5-46" data-line-number="46"></a>
<a class="sourceLine" id="cb5-47" data-line-number="47"><span class="kw">instance</span> (<span class="dt">Arbitrary</span> a, <span class="dt">Arbitrary</span> b) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Two</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-48" data-line-number="48">  arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-49" data-line-number="49">    a' <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-50" data-line-number="50">    b' <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-51" data-line-number="51">    return (<span class="dt">Two</span> a' b')</a>
<a class="sourceLine" id="cb5-52" data-line-number="52"></a>
<a class="sourceLine" id="cb5-53" data-line-number="53"><span class="kw">instance</span> (<span class="dt">Semigroup</span> a, <span class="dt">Semigroup</span> b) <span class="ot">=&gt;</span> <span class="dt">Semigroup</span> (<span class="dt">Two</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-54" data-line-number="54">  (<span class="dt">Two</span> a1 b1) <span class="fu">&lt;&gt;</span> (<span class="dt">Two</span> a2 b2) <span class="fu">=</span> <span class="dt">Two</span> (a1 <span class="fu">&lt;&gt;</span> a2) (b1 <span class="fu">&lt;&gt;</span> b2)</a>
<a class="sourceLine" id="cb5-55" data-line-number="55"></a>
<a class="sourceLine" id="cb5-56" data-line-number="56"><span class="kw">instance</span> (<span class="dt">Monoid</span> a, <span class="dt">Monoid</span> b) <span class="ot">=&gt;</span> <span class="dt">Monoid</span> (<span class="dt">Two</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-57" data-line-number="57">  mempty <span class="fu">=</span> <span class="dt">Two</span> mempty mempty</a>
<a class="sourceLine" id="cb5-58" data-line-number="58">  mappend (<span class="dt">Two</span> a1 b1) (<span class="dt">Two</span> a2 b2) <span class="fu">=</span> <span class="dt">Two</span> ((<span class="fu">M.&lt;&gt;</span>) a1 a2) ((<span class="fu">M.&lt;&gt;</span>) b1 b2)</a>
<a class="sourceLine" id="cb5-59" data-line-number="59"></a>
<a class="sourceLine" id="cb5-60" data-line-number="60"><span class="kw">type</span> <span class="dt">TwoAssoc</span> <span class="fu">=</span></a>
<a class="sourceLine" id="cb5-61" data-line-number="61">  (<span class="dt">Two</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> (<span class="dt">Two</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> (<span class="dt">Two</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-62" data-line-number="62"></a>
<a class="sourceLine" id="cb5-63" data-line-number="63"><span class="co">-- 4</span></a>
<a class="sourceLine" id="cb5-64" data-line-number="64"><span class="kw">data</span> <span class="dt">Three</span> a b c <span class="fu">=</span> <span class="dt">Three</span> a b c <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb5-65" data-line-number="65"></a>
<a class="sourceLine" id="cb5-66" data-line-number="66"><span class="kw">instance</span> (<span class="dt">Arbitrary</span> a, <span class="dt">Arbitrary</span> b, <span class="dt">Arbitrary</span> c) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Three</span> a b c) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-67" data-line-number="67">  arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-68" data-line-number="68">    a' <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-69" data-line-number="69">    b' <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-70" data-line-number="70">    c' <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-71" data-line-number="71">    return (<span class="dt">Three</span> a' b' c')</a>
<a class="sourceLine" id="cb5-72" data-line-number="72"></a>
<a class="sourceLine" id="cb5-73" data-line-number="73"><span class="kw">instance</span> (<span class="dt">Semigroup</span> a, <span class="dt">Semigroup</span> b, <span class="dt">Semigroup</span> c) <span class="ot">=&gt;</span> <span class="dt">Semigroup</span> (<span class="dt">Three</span> a b c) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-74" data-line-number="74">  (<span class="dt">Three</span> a1 b1 c1) <span class="fu">&lt;&gt;</span> (<span class="dt">Three</span> a2 b2 c2) <span class="fu">=</span> <span class="dt">Three</span> (a1 <span class="fu">&lt;&gt;</span> a2) (b1 <span class="fu">&lt;&gt;</span> b2) (c1 <span class="fu">&lt;&gt;</span> c2)</a>
<a class="sourceLine" id="cb5-75" data-line-number="75"></a>
<a class="sourceLine" id="cb5-76" data-line-number="76"><span class="kw">type</span> <span class="dt">ThreeAssoc</span> <span class="fu">=</span> (<span class="dt">Three</span> <span class="dt">String</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-77" data-line-number="77">                  (<span class="dt">Three</span> <span class="dt">String</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-78" data-line-number="78">                  (<span class="dt">Three</span> <span class="dt">String</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-79" data-line-number="79">                  <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-80" data-line-number="80"></a>
<a class="sourceLine" id="cb5-81" data-line-number="81"><span class="co">-- 5</span></a>
<a class="sourceLine" id="cb5-82" data-line-number="82"><span class="kw">data</span> <span class="dt">Four</span> a b c d <span class="fu">=</span> <span class="dt">Four</span> a b c d <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb5-83" data-line-number="83"></a>
<a class="sourceLine" id="cb5-84" data-line-number="84"><span class="kw">instance</span> (<span class="dt">Arbitrary</span> a, <span class="dt">Arbitrary</span> b, <span class="dt">Arbitrary</span> c, <span class="dt">Arbitrary</span> d) <span class="ot">=&gt;</span></a>
<a class="sourceLine" id="cb5-85" data-line-number="85">  <span class="dt">Arbitrary</span> (<span class="dt">Four</span> a b c d) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-86" data-line-number="86">    arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-87" data-line-number="87">      a' <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-88" data-line-number="88">      b' <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-89" data-line-number="89">      c' <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-90" data-line-number="90">      d' <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-91" data-line-number="91">      return (<span class="dt">Four</span> a' b' c' d')</a>
<a class="sourceLine" id="cb5-92" data-line-number="92"></a>
<a class="sourceLine" id="cb5-93" data-line-number="93"><span class="kw">instance</span> (<span class="dt">Semigroup</span> a, <span class="dt">Semigroup</span> b, <span class="dt">Semigroup</span> c, <span class="dt">Semigroup</span> d) <span class="ot">=&gt;</span></a>
<a class="sourceLine" id="cb5-94" data-line-number="94">  <span class="dt">Semigroup</span> (<span class="dt">Four</span> a b c d) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-95" data-line-number="95">    (<span class="dt">Four</span> a1 b1 c1 d1) <span class="fu">&lt;&gt;</span> (<span class="dt">Four</span> a2 b2 c2 d2) <span class="fu">=</span></a>
<a class="sourceLine" id="cb5-96" data-line-number="96">      <span class="dt">Four</span> (a1 <span class="fu">&lt;&gt;</span> a2) (b1 <span class="fu">&lt;&gt;</span> b2) (c1 <span class="fu">&lt;&gt;</span> c2) (d1 <span class="fu">&lt;&gt;</span> d2)</a>
<a class="sourceLine" id="cb5-97" data-line-number="97"></a>
<a class="sourceLine" id="cb5-98" data-line-number="98"><span class="kw">type</span> <span class="dt">FourAssoc</span> <span class="fu">=</span> (<span class="dt">Four</span> <span class="dt">String</span> <span class="dt">String</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-99" data-line-number="99">                 (<span class="dt">Four</span> <span class="dt">String</span> <span class="dt">String</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-100" data-line-number="100">                 (<span class="dt">Four</span> <span class="dt">String</span> <span class="dt">String</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-101" data-line-number="101">                 <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-102" data-line-number="102"></a>
<a class="sourceLine" id="cb5-103" data-line-number="103"><span class="co">-- 6</span></a>
<a class="sourceLine" id="cb5-104" data-line-number="104"><span class="kw">newtype</span> <span class="dt">BoolConj</span> <span class="fu">=</span> <span class="dt">BoolConj</span> <span class="dt">Bool</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb5-105" data-line-number="105"></a>
<a class="sourceLine" id="cb5-106" data-line-number="106"><span class="kw">instance</span> <span class="dt">Arbitrary</span> <span class="dt">BoolConj</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-107" data-line-number="107">  arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-108" data-line-number="108">    a <span class="ot">&lt;- arbitrary ::</span> <span class="dt">Gen</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-109" data-line-number="109">    return (<span class="dt">BoolConj</span> a)</a>
<a class="sourceLine" id="cb5-110" data-line-number="110"></a>
<a class="sourceLine" id="cb5-111" data-line-number="111"><span class="kw">instance</span> <span class="dt">Semigroup</span> <span class="dt">BoolConj</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-112" data-line-number="112">  (<span class="dt">BoolConj</span> <span class="dt">True</span>) <span class="fu">&lt;&gt;</span> (<span class="dt">BoolConj</span> <span class="dt">True</span>) <span class="fu">=</span> (<span class="dt">BoolConj</span> <span class="dt">True</span>)</a>
<a class="sourceLine" id="cb5-113" data-line-number="113">  _ <span class="fu">&lt;&gt;</span> _ <span class="fu">=</span> (<span class="dt">BoolConj</span> <span class="dt">False</span>)</a>
<a class="sourceLine" id="cb5-114" data-line-number="114"></a>
<a class="sourceLine" id="cb5-115" data-line-number="115"><span class="kw">instance</span> <span class="dt">Monoid</span> <span class="dt">BoolConj</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-116" data-line-number="116">  mempty <span class="fu">=</span> <span class="dt">BoolConj</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb5-117" data-line-number="117">  mappend (<span class="dt">BoolConj</span> <span class="dt">True</span>) (<span class="dt">BoolConj</span> <span class="dt">True</span>) <span class="fu">=</span> (<span class="dt">BoolConj</span> <span class="dt">True</span>)</a>
<a class="sourceLine" id="cb5-118" data-line-number="118">  mappend _ _ <span class="fu">=</span> (<span class="dt">BoolConj</span> <span class="dt">False</span>)</a>
<a class="sourceLine" id="cb5-119" data-line-number="119"></a>
<a class="sourceLine" id="cb5-120" data-line-number="120"><span class="kw">type</span> <span class="dt">BoolConjAssoc</span> <span class="fu">=</span> <span class="dt">BoolConj</span> <span class="ot">-&gt;</span> <span class="dt">BoolConj</span> <span class="ot">-&gt;</span> <span class="dt">BoolConj</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-121" data-line-number="121"></a>
<a class="sourceLine" id="cb5-122" data-line-number="122"><span class="co">-- 7</span></a>
<a class="sourceLine" id="cb5-123" data-line-number="123"><span class="kw">newtype</span> <span class="dt">BoolDisj</span> <span class="fu">=</span> <span class="dt">BoolDisj</span> <span class="dt">Bool</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb5-124" data-line-number="124"></a>
<a class="sourceLine" id="cb5-125" data-line-number="125"><span class="kw">instance</span> <span class="dt">Arbitrary</span> <span class="dt">BoolDisj</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-126" data-line-number="126">  arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-127" data-line-number="127">    a <span class="ot">&lt;- arbitrary ::</span> <span class="dt">Gen</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-128" data-line-number="128">    return (<span class="dt">BoolDisj</span> a)</a>
<a class="sourceLine" id="cb5-129" data-line-number="129"></a>
<a class="sourceLine" id="cb5-130" data-line-number="130"><span class="kw">instance</span> <span class="dt">Semigroup</span> <span class="dt">BoolDisj</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-131" data-line-number="131">  (<span class="dt">BoolDisj</span> <span class="dt">False</span>) <span class="fu">&lt;&gt;</span> (<span class="dt">BoolDisj</span> <span class="dt">False</span>) <span class="fu">=</span> (<span class="dt">BoolDisj</span> <span class="dt">False</span>)</a>
<a class="sourceLine" id="cb5-132" data-line-number="132">  _ <span class="fu">&lt;&gt;</span> _ <span class="fu">=</span> (<span class="dt">BoolDisj</span> <span class="dt">True</span>)</a>
<a class="sourceLine" id="cb5-133" data-line-number="133"></a>
<a class="sourceLine" id="cb5-134" data-line-number="134"><span class="kw">instance</span> <span class="dt">Monoid</span> <span class="dt">BoolDisj</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-135" data-line-number="135">  mempty <span class="fu">=</span> <span class="dt">BoolDisj</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb5-136" data-line-number="136">  mappend (<span class="dt">BoolDisj</span> <span class="dt">False</span>) (<span class="dt">BoolDisj</span> <span class="dt">False</span>) <span class="fu">=</span> (<span class="dt">BoolDisj</span> <span class="dt">False</span>)</a>
<a class="sourceLine" id="cb5-137" data-line-number="137">  mappend _ _ <span class="fu">=</span> (<span class="dt">BoolDisj</span> <span class="dt">True</span>)</a>
<a class="sourceLine" id="cb5-138" data-line-number="138"></a>
<a class="sourceLine" id="cb5-139" data-line-number="139"><span class="kw">type</span> <span class="dt">BoolDisjAssoc</span> <span class="fu">=</span> <span class="dt">BoolDisj</span> <span class="ot">-&gt;</span> <span class="dt">BoolDisj</span> <span class="ot">-&gt;</span> <span class="dt">BoolDisj</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-140" data-line-number="140"></a>
<a class="sourceLine" id="cb5-141" data-line-number="141"><span class="co">-- 8</span></a>
<a class="sourceLine" id="cb5-142" data-line-number="142"><span class="kw">data</span> <span class="dt">Or</span> a b <span class="fu">=</span> <span class="dt">Fst</span> a <span class="fu">|</span> <span class="dt">Snd</span> b <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb5-143" data-line-number="143"></a>
<a class="sourceLine" id="cb5-144" data-line-number="144"><span class="kw">instance</span> (<span class="dt">Arbitrary</span> a, <span class="dt">Arbitrary</span> b) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Or</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-145" data-line-number="145">  arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-146" data-line-number="146">    a' <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-147" data-line-number="147">    b' <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-148" data-line-number="148">    oneof [return (<span class="dt">Fst</span> a'), return (<span class="dt">Snd</span> b')]</a>
<a class="sourceLine" id="cb5-149" data-line-number="149"></a>
<a class="sourceLine" id="cb5-150" data-line-number="150"><span class="kw">instance</span> <span class="dt">Semigroup</span> (<span class="dt">Or</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-151" data-line-number="151">  (<span class="dt">Snd</span> b) <span class="fu">&lt;&gt;</span> _       <span class="fu">=</span> (<span class="dt">Snd</span> b)</a>
<a class="sourceLine" id="cb5-152" data-line-number="152">  _       <span class="fu">&lt;&gt;</span> (<span class="dt">Snd</span> b) <span class="fu">=</span> (<span class="dt">Snd</span> b)</a>
<a class="sourceLine" id="cb5-153" data-line-number="153">  _       <span class="fu">&lt;&gt;</span> (<span class="dt">Fst</span> a) <span class="fu">=</span> (<span class="dt">Fst</span> a)</a>
<a class="sourceLine" id="cb5-154" data-line-number="154"></a>
<a class="sourceLine" id="cb5-155" data-line-number="155"><span class="kw">type</span> <span class="dt">OrAssoc</span> <span class="fu">=</span></a>
<a class="sourceLine" id="cb5-156" data-line-number="156">  (<span class="dt">Or</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> (<span class="dt">Or</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> (<span class="dt">Or</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-157" data-line-number="157"></a>
<a class="sourceLine" id="cb5-158" data-line-number="158"><span class="co">-- 9</span></a>
<a class="sourceLine" id="cb5-159" data-line-number="159"><span class="kw">newtype</span> <span class="dt">Combine</span> a b <span class="fu">=</span> <span class="dt">Combine</span> {<span class="ot"> unCombine ::</span> (a <span class="ot">-&gt;</span> b) }</a>
<a class="sourceLine" id="cb5-160" data-line-number="160"></a>
<a class="sourceLine" id="cb5-161" data-line-number="161"><span class="kw">instance</span> (<span class="dt">Show</span> a, <span class="dt">Show</span> b) <span class="ot">=&gt;</span> <span class="dt">Show</span> (<span class="dt">Combine</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-162" data-line-number="162">  show _ <span class="fu">=</span> <span class="st">&quot;Combine&quot;</span></a>
<a class="sourceLine" id="cb5-163" data-line-number="163"></a>
<a class="sourceLine" id="cb5-164" data-line-number="164"><span class="kw">instance</span> (<span class="dt">Semigroup</span> b) <span class="ot">=&gt;</span> <span class="dt">Semigroup</span> (<span class="dt">Combine</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-165" data-line-number="165">  (<span class="dt">Combine</span> f) <span class="fu">&lt;&gt;</span> (<span class="dt">Combine</span> g) <span class="fu">=</span> <span class="dt">Combine</span> (\n <span class="ot">-&gt;</span> (f n) <span class="fu">&lt;&gt;</span> (g n))</a>
<a class="sourceLine" id="cb5-166" data-line-number="166"></a>
<a class="sourceLine" id="cb5-167" data-line-number="167"><span class="kw">instance</span> (<span class="dt">Monoid</span> b) <span class="ot">=&gt;</span> <span class="dt">Monoid</span> (<span class="dt">Combine</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-168" data-line-number="168">  mempty <span class="fu">=</span> <span class="dt">Combine</span> (\n <span class="ot">-&gt;</span> mempty)</a>
<a class="sourceLine" id="cb5-169" data-line-number="169">  mappend (<span class="dt">Combine</span> f) (<span class="dt">Combine</span> g) <span class="fu">=</span> <span class="dt">Combine</span> (\n <span class="ot">-&gt;</span> (<span class="fu">M.&lt;&gt;</span>) (f n) (g n))</a>
<a class="sourceLine" id="cb5-170" data-line-number="170"></a>
<a class="sourceLine" id="cb5-171" data-line-number="171"><span class="kw">instance</span> (<span class="dt">CoArbitrary</span> a, <span class="dt">Arbitrary</span> b) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Combine</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-172" data-line-number="172">  arbitrary <span class="fu">=</span> fmap <span class="dt">Combine</span> <span class="fu">$</span> promote (\n <span class="ot">-&gt;</span> coarbitrary n arbitrary)</a>
<a class="sourceLine" id="cb5-173" data-line-number="173"></a>
<a class="sourceLine" id="cb5-174" data-line-number="174"><span class="ot">combineAssoc ::</span> (<span class="dt">Combine</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-175" data-line-number="175">                (<span class="dt">Combine</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-176" data-line-number="176">                (<span class="dt">Combine</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-177" data-line-number="177">                <span class="dt">String</span> <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-178" data-line-number="178">                <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-179" data-line-number="179">combineAssoc a b c s <span class="fu">=</span></a>
<a class="sourceLine" id="cb5-180" data-line-number="180">  (unCombine (a <span class="fu">&lt;&gt;</span> (b <span class="fu">&lt;&gt;</span> c)) s) <span class="fu">==</span> (unCombine ((a <span class="fu">&lt;&gt;</span> b) <span class="fu">&lt;&gt;</span> c) s)</a>
<a class="sourceLine" id="cb5-181" data-line-number="181"></a>
<a class="sourceLine" id="cb5-182" data-line-number="182"><span class="ot">combineLeftIdentity ::</span> (<span class="dt">Combine</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-183" data-line-number="183">combineLeftIdentity a s <span class="fu">=</span> ((unCombine (mempty <span class="fu">M.&lt;&gt;</span> a)) s) <span class="fu">==</span> ((unCombine a) s)</a>
<a class="sourceLine" id="cb5-184" data-line-number="184"></a>
<a class="sourceLine" id="cb5-185" data-line-number="185"><span class="ot">combineRightIdentity ::</span> (<span class="dt">Combine</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-186" data-line-number="186">combineRightIdentity a s <span class="fu">=</span> ((unCombine (a <span class="fu">M.&lt;&gt;</span> mempty)) s) <span class="fu">==</span> ((unCombine a) s)</a>
<a class="sourceLine" id="cb5-187" data-line-number="187"></a>
<a class="sourceLine" id="cb5-188" data-line-number="188"></a>
<a class="sourceLine" id="cb5-189" data-line-number="189"><span class="co">-- 10</span></a>
<a class="sourceLine" id="cb5-190" data-line-number="190"><span class="kw">newtype</span> <span class="dt">Comp</span> a <span class="fu">=</span> <span class="dt">Comp</span> {<span class="ot"> unComp ::</span> (a <span class="ot">-&gt;</span> a) }</a>
<a class="sourceLine" id="cb5-191" data-line-number="191"></a>
<a class="sourceLine" id="cb5-192" data-line-number="192"><span class="kw">instance</span> <span class="dt">Show</span> (<span class="dt">Comp</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-193" data-line-number="193">  show _ <span class="fu">=</span> <span class="st">&quot;Comp&quot;</span></a>
<a class="sourceLine" id="cb5-194" data-line-number="194"></a>
<a class="sourceLine" id="cb5-195" data-line-number="195"><span class="kw">instance</span> (<span class="dt">Semigroup</span> a) <span class="ot">=&gt;</span> <span class="dt">Semigroup</span> (<span class="dt">Comp</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-196" data-line-number="196">  (<span class="dt">Comp</span> f) <span class="fu">&lt;&gt;</span> (<span class="dt">Comp</span> g) <span class="fu">=</span> <span class="dt">Comp</span> (f <span class="fu">.</span> g)</a>
<a class="sourceLine" id="cb5-197" data-line-number="197"></a>
<a class="sourceLine" id="cb5-198" data-line-number="198"><span class="kw">instance</span> (<span class="dt">Monoid</span> a) <span class="ot">=&gt;</span> <span class="dt">Monoid</span> (<span class="dt">Comp</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-199" data-line-number="199">  mempty <span class="fu">=</span> <span class="dt">Comp</span> id</a>
<a class="sourceLine" id="cb5-200" data-line-number="200">  mappend (<span class="dt">Comp</span> f) (<span class="dt">Comp</span> g) <span class="fu">=</span> <span class="dt">Comp</span> (f <span class="fu">.</span> g)</a>
<a class="sourceLine" id="cb5-201" data-line-number="201"></a>
<a class="sourceLine" id="cb5-202" data-line-number="202"><span class="kw">instance</span> (<span class="dt">CoArbitrary</span> a, <span class="dt">Arbitrary</span> a) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Comp</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-203" data-line-number="203">  arbitrary <span class="fu">=</span> fmap <span class="dt">Comp</span> <span class="fu">$</span> promote (\n <span class="ot">-&gt;</span> coarbitrary n arbitrary)</a>
<a class="sourceLine" id="cb5-204" data-line-number="204"></a>
<a class="sourceLine" id="cb5-205" data-line-number="205"><span class="ot">compAssoc ::</span> (<span class="dt">Comp</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> (<span class="dt">Comp</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> (<span class="dt">Comp</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-206" data-line-number="206">compAssoc a b c s <span class="fu">=</span> (unComp (a <span class="fu">&lt;&gt;</span> (b <span class="fu">&lt;&gt;</span> c)) s) <span class="fu">==</span> (unComp ((a <span class="fu">&lt;&gt;</span> b) <span class="fu">&lt;&gt;</span> c) s)</a>
<a class="sourceLine" id="cb5-207" data-line-number="207"></a>
<a class="sourceLine" id="cb5-208" data-line-number="208"><span class="ot">compLeftIdentity ::</span> (<span class="dt">Comp</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-209" data-line-number="209">compLeftIdentity a s <span class="fu">=</span> ((unComp (mempty <span class="fu">M.&lt;&gt;</span> a)) s) <span class="fu">==</span> ((unComp a) s)</a>
<a class="sourceLine" id="cb5-210" data-line-number="210"></a>
<a class="sourceLine" id="cb5-211" data-line-number="211"><span class="ot">compRightIdentity ::</span> (<span class="dt">Comp</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-212" data-line-number="212">compRightIdentity a s <span class="fu">=</span> ((unComp (a <span class="fu">M.&lt;&gt;</span> mempty)) s) <span class="fu">==</span> ((unComp a) s)</a>
<a class="sourceLine" id="cb5-213" data-line-number="213"></a>
<a class="sourceLine" id="cb5-214" data-line-number="214"><span class="co">-- 11</span></a>
<a class="sourceLine" id="cb5-215" data-line-number="215"><span class="kw">data</span> <span class="dt">Validation</span> a b <span class="fu">=</span> <span class="dt">Fail</span> a <span class="fu">|</span> <span class="dt">Pass</span> b <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb5-216" data-line-number="216"></a>
<a class="sourceLine" id="cb5-217" data-line-number="217"><span class="kw">instance</span> <span class="dt">Semigroup</span> a <span class="ot">=&gt;</span> <span class="dt">Semigroup</span> (<span class="dt">Validation</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-218" data-line-number="218">  (<span class="dt">Fail</span> a) <span class="fu">&lt;&gt;</span> (<span class="dt">Fail</span> b) <span class="fu">=</span> (<span class="dt">Fail</span> (a <span class="fu">&lt;&gt;</span> b))</a>
<a class="sourceLine" id="cb5-219" data-line-number="219">  _        <span class="fu">&lt;&gt;</span> (<span class="dt">Fail</span> a) <span class="fu">=</span> (<span class="dt">Fail</span> a)</a>
<a class="sourceLine" id="cb5-220" data-line-number="220">  (<span class="dt">Fail</span> a) <span class="fu">&lt;&gt;</span> _        <span class="fu">=</span> (<span class="dt">Fail</span> a)</a>
<a class="sourceLine" id="cb5-221" data-line-number="221">  _        <span class="fu">&lt;&gt;</span> (<span class="dt">Pass</span> b) <span class="fu">=</span> (<span class="dt">Pass</span> b)</a>
<a class="sourceLine" id="cb5-222" data-line-number="222"></a>
<a class="sourceLine" id="cb5-223" data-line-number="223"><span class="kw">instance</span> (<span class="dt">Arbitrary</span> a, <span class="dt">Arbitrary</span> b) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">Validation</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-224" data-line-number="224">  arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-225" data-line-number="225">    a <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-226" data-line-number="226">    b <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-227" data-line-number="227">    oneof [return (<span class="dt">Fail</span> a), return (<span class="dt">Pass</span> b)]</a>
<a class="sourceLine" id="cb5-228" data-line-number="228"></a>
<a class="sourceLine" id="cb5-229" data-line-number="229"><span class="kw">type</span> <span class="dt">ValidationAssoc</span> <span class="fu">=</span> (<span class="dt">Validation</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-230" data-line-number="230">                       (<span class="dt">Validation</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-231" data-line-number="231">                       (<span class="dt">Validation</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-232" data-line-number="232">                       <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-233" data-line-number="233"></a>
<a class="sourceLine" id="cb5-234" data-line-number="234"><span class="co">-- 12</span></a>
<a class="sourceLine" id="cb5-235" data-line-number="235"><span class="kw">newtype</span> <span class="dt">AccRight</span> a b <span class="fu">=</span> <span class="dt">AccRight</span> (<span class="dt">Validation</span> a b) <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb5-236" data-line-number="236"></a>
<a class="sourceLine" id="cb5-237" data-line-number="237"><span class="kw">instance</span> (<span class="dt">Semigroup</span> b) <span class="ot">=&gt;</span> <span class="dt">Semigroup</span> (<span class="dt">AccRight</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-238" data-line-number="238">  (<span class="dt">AccRight</span> (<span class="dt">Pass</span> a)) <span class="fu">&lt;&gt;</span> (<span class="dt">AccRight</span> (<span class="dt">Pass</span> b)) <span class="fu">=</span> <span class="dt">AccRight</span> (<span class="dt">Pass</span> (a <span class="fu">&lt;&gt;</span> b))</a>
<a class="sourceLine" id="cb5-239" data-line-number="239">  (<span class="dt">AccRight</span> (<span class="dt">Fail</span> a)) <span class="fu">&lt;&gt;</span> _                   <span class="fu">=</span> <span class="dt">AccRight</span> (<span class="dt">Fail</span> a)</a>
<a class="sourceLine" id="cb5-240" data-line-number="240">  _                   <span class="fu">&lt;&gt;</span> (<span class="dt">AccRight</span> (<span class="dt">Fail</span> b)) <span class="fu">=</span> <span class="dt">AccRight</span> (<span class="dt">Fail</span> b)</a>
<a class="sourceLine" id="cb5-241" data-line-number="241"></a>
<a class="sourceLine" id="cb5-242" data-line-number="242"><span class="kw">instance</span> (<span class="dt">Arbitrary</span> a, <span class="dt">Arbitrary</span> b) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">AccRight</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-243" data-line-number="243">  arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-244" data-line-number="244">    a <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-245" data-line-number="245">    b <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-246" data-line-number="246">    oneof [return (<span class="dt">AccRight</span> (<span class="dt">Fail</span> a)), return (<span class="dt">AccRight</span> (<span class="dt">Pass</span> b))]</a>
<a class="sourceLine" id="cb5-247" data-line-number="247"></a>
<a class="sourceLine" id="cb5-248" data-line-number="248"><span class="kw">type</span> <span class="dt">AccRightAssoc</span> <span class="fu">=</span> (<span class="dt">AccRight</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-249" data-line-number="249">                     (<span class="dt">AccRight</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-250" data-line-number="250">                     (<span class="dt">AccRight</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-251" data-line-number="251">                     <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-252" data-line-number="252"></a>
<a class="sourceLine" id="cb5-253" data-line-number="253"><span class="co">-- 13</span></a>
<a class="sourceLine" id="cb5-254" data-line-number="254"><span class="kw">newtype</span> <span class="dt">AccBoth</span> a b <span class="fu">=</span> <span class="dt">AccBoth</span> (<span class="dt">Validation</span> a b) <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</a>
<a class="sourceLine" id="cb5-255" data-line-number="255"></a>
<a class="sourceLine" id="cb5-256" data-line-number="256"><span class="kw">instance</span> (<span class="dt">Semigroup</span> a, <span class="dt">Semigroup</span> b) <span class="ot">=&gt;</span> <span class="dt">Semigroup</span> (<span class="dt">AccBoth</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-257" data-line-number="257">  (<span class="dt">AccBoth</span> (<span class="dt">Pass</span> a)) <span class="fu">&lt;&gt;</span> (<span class="dt">AccBoth</span> (<span class="dt">Pass</span> b)) <span class="fu">=</span> <span class="dt">AccBoth</span> (<span class="dt">Pass</span> (a <span class="fu">&lt;&gt;</span> b))</a>
<a class="sourceLine" id="cb5-258" data-line-number="258">  (<span class="dt">AccBoth</span> (<span class="dt">Fail</span> a)) <span class="fu">&lt;&gt;</span> (<span class="dt">AccBoth</span> (<span class="dt">Fail</span> b)) <span class="fu">=</span> <span class="dt">AccBoth</span> (<span class="dt">Fail</span> (a <span class="fu">&lt;&gt;</span> b))</a>
<a class="sourceLine" id="cb5-259" data-line-number="259">  _                  <span class="fu">&lt;&gt;</span> (<span class="dt">AccBoth</span> (<span class="dt">Fail</span> b)) <span class="fu">=</span> <span class="dt">AccBoth</span> (<span class="dt">Fail</span> b)</a>
<a class="sourceLine" id="cb5-260" data-line-number="260">  (<span class="dt">AccBoth</span> (<span class="dt">Fail</span> a)) <span class="fu">&lt;&gt;</span> _                  <span class="fu">=</span> <span class="dt">AccBoth</span> (<span class="dt">Fail</span> a)</a>
<a class="sourceLine" id="cb5-261" data-line-number="261"></a>
<a class="sourceLine" id="cb5-262" data-line-number="262"><span class="kw">instance</span> (<span class="dt">Arbitrary</span> a, <span class="dt">Arbitrary</span> b) <span class="ot">=&gt;</span> <span class="dt">Arbitrary</span> (<span class="dt">AccBoth</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb5-263" data-line-number="263">  arbitrary <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-264" data-line-number="264">    a <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-265" data-line-number="265">    b <span class="ot">&lt;-</span> arbitrary</a>
<a class="sourceLine" id="cb5-266" data-line-number="266">    oneof [return (<span class="dt">AccBoth</span> (<span class="dt">Fail</span> a)), return (<span class="dt">AccBoth</span> (<span class="dt">Pass</span> b))]</a>
<a class="sourceLine" id="cb5-267" data-line-number="267"></a>
<a class="sourceLine" id="cb5-268" data-line-number="268"><span class="kw">type</span> <span class="dt">AccBothAssoc</span> <span class="fu">=</span> (<span class="dt">AccBoth</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-269" data-line-number="269">                    (<span class="dt">AccBoth</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-270" data-line-number="270">                    (<span class="dt">AccBoth</span> <span class="dt">String</span> <span class="dt">String</span>) <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb5-271" data-line-number="271">                    <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-272" data-line-number="272"><span class="co">-- Testing</span></a>
<a class="sourceLine" id="cb5-273" data-line-number="273"><span class="ot">semigroupAssoc ::</span> (<span class="dt">Eq</span> m, <span class="dt">Semigroup</span> m) <span class="ot">=&gt;</span> m <span class="ot">-&gt;</span> m <span class="ot">-&gt;</span> m <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-274" data-line-number="274">semigroupAssoc a b c <span class="fu">=</span> (a <span class="fu">&lt;&gt;</span> (b <span class="fu">&lt;&gt;</span> c)) <span class="fu">==</span> ((a <span class="fu">&lt;&gt;</span> b) <span class="fu">&lt;&gt;</span> c)</a>
<a class="sourceLine" id="cb5-275" data-line-number="275"></a>
<a class="sourceLine" id="cb5-276" data-line-number="276"><span class="ot">monoidLeftIdentity ::</span> (<span class="dt">Eq</span> m, <span class="dt">Monoid</span> m) <span class="ot">=&gt;</span> m <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-277" data-line-number="277">monoidLeftIdentity a <span class="fu">=</span> ((<span class="fu">M.&lt;&gt;</span>) mempty a) <span class="fu">==</span> a</a>
<a class="sourceLine" id="cb5-278" data-line-number="278"></a>
<a class="sourceLine" id="cb5-279" data-line-number="279"><span class="ot">monoidRightIdentity ::</span> (<span class="dt">Eq</span> m, <span class="dt">Monoid</span> m) <span class="ot">=&gt;</span> m <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-280" data-line-number="280">monoidRightIdentity a <span class="fu">=</span> ((<span class="fu">M.&lt;&gt;</span>) a mempty) <span class="fu">==</span> a</a>
<a class="sourceLine" id="cb5-281" data-line-number="281"></a>
<a class="sourceLine" id="cb5-282" data-line-number="282"><span class="ot">main ::</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb5-283" data-line-number="283">main <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-284" data-line-number="284">  quickCheck (<span class="ot">semigroupAssoc ::</span> <span class="dt">TrivAssoc</span>)</a>
<a class="sourceLine" id="cb5-285" data-line-number="285">  quickCheck (<span class="ot">monoidLeftIdentity ::</span> <span class="dt">Trivial</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb5-286" data-line-number="286">  quickCheck (<span class="ot">monoidRightIdentity ::</span> <span class="dt">Trivial</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb5-287" data-line-number="287">  quickCheck (<span class="ot">semigroupAssoc ::</span> <span class="dt">IdentAssoc</span>)</a>
<a class="sourceLine" id="cb5-288" data-line-number="288">  quickCheck (<span class="ot">monoidLeftIdentity ::</span> <span class="dt">Identity</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb5-289" data-line-number="289">  quickCheck (<span class="ot">monoidRightIdentity ::</span> <span class="dt">Identity</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb5-290" data-line-number="290">  quickCheck (<span class="ot">semigroupAssoc ::</span> <span class="dt">TwoAssoc</span>)</a>
<a class="sourceLine" id="cb5-291" data-line-number="291">  quickCheck (<span class="ot">monoidLeftIdentity ::</span> <span class="dt">Two</span> <span class="dt">String</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb5-292" data-line-number="292">  quickCheck (<span class="ot">monoidRightIdentity ::</span> <span class="dt">Two</span> <span class="dt">String</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb5-293" data-line-number="293">  quickCheck (<span class="ot">semigroupAssoc ::</span> <span class="dt">ThreeAssoc</span>)</a>
<a class="sourceLine" id="cb5-294" data-line-number="294">  quickCheck (<span class="ot">semigroupAssoc ::</span> <span class="dt">FourAssoc</span>)</a>
<a class="sourceLine" id="cb5-295" data-line-number="295">  quickCheck (<span class="ot">semigroupAssoc ::</span> <span class="dt">BoolConjAssoc</span>)</a>
<a class="sourceLine" id="cb5-296" data-line-number="296">  quickCheck (<span class="ot">monoidLeftIdentity ::</span> <span class="dt">BoolConj</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb5-297" data-line-number="297">  quickCheck (<span class="ot">monoidRightIdentity ::</span> <span class="dt">BoolConj</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb5-298" data-line-number="298">  quickCheck (<span class="ot">semigroupAssoc ::</span> <span class="dt">BoolDisjAssoc</span>)</a>
<a class="sourceLine" id="cb5-299" data-line-number="299">  quickCheck (<span class="ot">monoidLeftIdentity ::</span> <span class="dt">BoolDisj</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb5-300" data-line-number="300">  quickCheck (<span class="ot">monoidRightIdentity ::</span> <span class="dt">BoolDisj</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb5-301" data-line-number="301">  quickCheck (<span class="ot">semigroupAssoc ::</span> <span class="dt">OrAssoc</span>)</a>
<a class="sourceLine" id="cb5-302" data-line-number="302">  quickCheck combineAssoc</a>
<a class="sourceLine" id="cb5-303" data-line-number="303">  quickCheck combineLeftIdentity</a>
<a class="sourceLine" id="cb5-304" data-line-number="304">  quickCheck combineRightIdentity</a>
<a class="sourceLine" id="cb5-305" data-line-number="305">  quickCheck compAssoc</a>
<a class="sourceLine" id="cb5-306" data-line-number="306">  quickCheck compLeftIdentity</a>
<a class="sourceLine" id="cb5-307" data-line-number="307">  quickCheck compRightIdentity</a>
<a class="sourceLine" id="cb5-308" data-line-number="308">  quickCheck (<span class="ot">semigroupAssoc ::</span> <span class="dt">ValidationAssoc</span>)</a>
<a class="sourceLine" id="cb5-309" data-line-number="309">  quickCheck (<span class="ot">semigroupAssoc ::</span> <span class="dt">AccRightAssoc</span>)</a>
<a class="sourceLine" id="cb5-310" data-line-number="310">  quickCheck (<span class="ot">semigroupAssoc ::</span> <span class="dt">AccBothAssoc</span>)</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co">--15/Mem.hs</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">module</span> <span class="dt">Mem</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw">import</span> <span class="dt">Data.Monoid</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw">import</span> <span class="dt">Test.QuickCheck</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="kw">newtype</span> <span class="dt">Mem</span> s a <span class="fu">=</span> <span class="dt">Mem</span> {<span class="ot"> runMem ::</span> s <span class="ot">-&gt;</span> (a , s) }</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="kw">instance</span> <span class="dt">Monoid</span> a <span class="ot">=&gt;</span> <span class="dt">Monoid</span> (<span class="dt">Mem</span> s a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  mempty <span class="fu">=</span> <span class="dt">Mem</span> (\n <span class="ot">-&gt;</span> (mempty, n))</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">  mappend (<span class="dt">Mem</span> f) (<span class="dt">Mem</span> g) <span class="fu">=</span> <span class="dt">Mem</span> h <span class="kw">where</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12">    h <span class="fu">=</span> (\n <span class="ot">-&gt;</span> ((fst <span class="fu">$</span> f n) <span class="fu">&lt;&gt;</span> (fst <span class="fu">$</span> g n), snd <span class="fu">$</span> f <span class="fu">$</span> snd <span class="fu">$</span> g n))</a>
<a class="sourceLine" id="cb6-13" data-line-number="13"></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">f' <span class="fu">=</span> <span class="dt">Mem</span> <span class="fu">$</span> \s <span class="ot">-&gt;</span> (<span class="st">&quot;hi&quot;</span>, s <span class="fu">+</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-15" data-line-number="15"></a>
<a class="sourceLine" id="cb6-16" data-line-number="16">main <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17">  <span class="kw">let</span> rmzero <span class="fu">=</span> runMem mempty <span class="dv">0</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18">      rmleft <span class="fu">=</span> runMem (f' <span class="fu">&lt;&gt;</span> mempty) <span class="dv">0</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19">      rmright <span class="fu">=</span> runMem (mempty <span class="fu">&lt;&gt;</span> f') <span class="dv">0</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20">  print <span class="fu">$</span> rmleft</a>
<a class="sourceLine" id="cb6-21" data-line-number="21">  print <span class="fu">$</span> rmright</a>
<a class="sourceLine" id="cb6-22" data-line-number="22">  print <span class="fu">$</span> (<span class="ot">rmzero ::</span> (<span class="dt">String</span>, <span class="dt">Int</span>))</a>
<a class="sourceLine" id="cb6-23" data-line-number="23">  print <span class="fu">$</span> rmleft <span class="fu">==</span> runMem f' <span class="dv">0</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24">  print <span class="fu">$</span> rmright <span class="fu">==</span> runMem f' <span class="dv">0</span></a></code></pre></div>
<h2 id="follow-up-resources">15.17 Follow-up resources</h2>
<ol type="1">
<li>Algebraic structure; Simple English Wikipedia</li>
<li>Haskell Monoids and Their Uses; Dan Piponi</li>
</ol>
<hr />

        </div>
        <div id="footer">
          <p>&copy; <script>document.write(new Date().getFullYear());</script>
             John Chandler Burnham.
            Generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>
          </p>
        </div>
    </body>
</html>
